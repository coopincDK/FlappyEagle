<!DOCTYPE html>
<html lang="da">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Flappy Eagle</title>
    
    <!-- PWA / Webapp Meta Tags -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Flappy Eagle">
    <meta name="application-name" content="Flappy Eagle">
    <meta name="theme-color" content="#4ec0ca">
    <meta name="description" content="Flap din vej gennem r√∏rene! Samle m√∏nter, l√•s skins op og bliv den bedste!">
    
    <!-- App Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3Eü¶Ö%3C/text%3E%3C/svg%3E">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='90'%3Eü¶Ö%3C/text%3E%3C/svg%3E">
    
    <!-- Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkZsYXBweSBFYWdsZSIsCiAgInNob3J0X25hbWUiOiAiRmxhcHB5IiwKICAic3RhcnRfdXJsIjogIi4iLAogICJkaXNwbGF5IjogInN0YW5kYWxvbmUiLAogICJiYWNrZ3JvdW5kX2NvbG9yIjogIiM0ZWMwY2EiLAogICJ0aGVtZV9jb2xvciI6ICIjNGVjMGNhIiwKICAiZGVzY3JpcHRpb24iOiAiRmxhcCBkaW4gdmVqIGdlbm5lbSByw7hyZW5lISIsCiAgImljb25zIjogW10KfQ==">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(to bottom, #4ec0ca 0%, #4ec0ca 80%, #ded895 80%, #ded895 100%);
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -webkit-tap-highlight-color: transparent;
            touch-action: manipulation;
        }

        #gameContainer {
            position: relative;
            width: 100vw;
            height: 100vh;
            background: linear-gradient(to bottom, #4ec0ca 0%, #4ec0ca 80%, #ded895 80%, #ded895 100%);
            border: none;
            overflow: hidden;
            transition: background 1s ease;
        }
        
        /* Vejr-effekter */
        #gameContainer.night {
            background: linear-gradient(to bottom, #0a1128 0%, #1a2332 80%, #2a3142 80%, #2a3142 100%);
        }
        
        #gameContainer.rain {
            background: linear-gradient(to bottom, #5a7a8a 0%, #5a7a8a 80%, #8a9a7a 80%, #8a9a7a 100%);
        }
        
        #gameContainer.storm {
            background: linear-gradient(to bottom, #2a3a4a 0%, #2a3a4a 80%, #4a5a6a 80%, #4a5a6a 100%);
        }
        
        #gameContainer.snow {
            background: linear-gradient(to bottom, #d0e0f0 0%, #d0e0f0 80%, #e0f0ff 80%, #e0f0ff 100%);
        }
        
        .weather-particle {
            position: absolute;
            pointer-events: none;
            z-index: 100;
        }
        
        .raindrop {
            width: 2px;
            height: 20px;
            background: linear-gradient(to bottom, rgba(174, 194, 224, 0.8), rgba(174, 194, 224, 0));
            animation: fall linear infinite;
        }
        
        .snowflake {
            color: white;
            font-size: 20px;
            animation: fall linear infinite, sway 3s ease-in-out infinite;
        }
        
        .lightning {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            pointer-events: none;
            z-index: 200;
            opacity: 0;
        }
        
        .cloud {
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 100px;
            pointer-events: none;
            z-index: 5;
            animation: floatCloud linear infinite;
        }
        
        .cloud::before,
        .cloud::after {
            content: '';
            position: absolute;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 100px;
        }
        
        .cloud::before {
            width: 50%;
            height: 80%;
            top: -40%;
            left: 10%;
        }
        
        .cloud::after {
            width: 60%;
            height: 70%;
            top: -30%;
            right: 10%;
        }
        
        @keyframes fall {
            to { transform: translateY(100vh); }
        }
        
        @keyframes sway {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(20px); }
        }
        
        @keyframes floatCloud {
            from { transform: translateX(-200px); }
            to { transform: translateX(calc(100vw + 200px)); }
        }

        #bird {
            position: absolute;
            width: 50px;
            height: 38px;
            background: linear-gradient(135deg, #8B4513 0%, #654321 50%, #3E2723 100%);
            border-radius: 55% 45% 45% 55%;
            left: 80px;
            transition: transform 0.1s;
            box-shadow: 
                0 8px 20px rgba(0,0,0,0.6),
                0 4px 10px rgba(0,0,0,0.4),
                inset -6px -6px 15px rgba(0,0,0,0.4),
                inset 4px 4px 10px rgba(139,69,19,0.3);
            border: 2px solid #5D4037;
            transform-style: preserve-3d;
            transform: perspective(500px) rotateY(-5deg);
        }

        /* √òje - √∏rne√∏je (gult og intenst) */
        #bird::before {
            content: '';
            position: absolute;
            width: 11px;
            height: 11px;
            background: radial-gradient(circle, #FFD700 20%, #FFA500 40%, #333 40%, #333 70%, black 70%);
            border-radius: 50%;
            top: 7px;
            right: 10px;
            box-shadow: 0 0 5px rgba(255, 215, 0, 0.6), inset 1px 1px 2px rgba(0,0,0,0.3);
        }

        /* 3D Highlight p√• kroppen */
        #bird::after {
            content: '';
            position: absolute;
            width: 20px;
            height: 15px;
            background: radial-gradient(ellipse at 30% 30%, rgba(255,255,255,0.5), rgba(255,255,255,0.2) 50%, transparent);
            border-radius: 50%;
            top: 5px;
            left: 15px;
            filter: blur(2px);
        }

        /* N√¶b - 3D kraftigt √∏rnen√¶b (gult/orange) */
        #bird .beak {
            position: absolute;
            width: 0;
            height: 0;
            border-left: 20px solid #FFA500;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            right: -16px;
            top: 12px;
            filter: 
                drop-shadow(3px 3px 6px rgba(0,0,0,0.6))
                drop-shadow(1px 1px 2px rgba(0,0,0,0.4));
            transform-style: preserve-3d;
            transform: perspective(500px) rotateY(-10deg) translateZ(3px);
        }
        
        /* Krog p√• n√¶bet */
        #bird .beak::after {
            content: '';
            position: absolute;
            width: 0;
            height: 0;
            border-left: 8px solid #FF8C00;
            border-top: 3px solid transparent;
            border-bottom: 3px solid transparent;
            right: -8px;
            top: -3px;
            transform: rotate(20deg);
        }

        /* Vinge - 3D kraftig √∏rnevinge */
        #bird .wing {
            position: absolute;
            width: 32px;
            height: 22px;
            background: linear-gradient(135deg, #6D4C41 0%, #4E342E 50%, #3E2723 100%);
            border-radius: 60% 40% 20% 80%;
            left: 8px;
            top: 10px;
            transform-origin: 20% center;
            animation: flapWing3D 0.3s ease-in-out infinite;
            box-shadow: 
                0 6px 12px rgba(0,0,0,0.5),
                0 3px 6px rgba(0,0,0,0.3),
                inset -2px -2px 5px rgba(0,0,0,0.3),
                inset 2px 2px 4px rgba(109,76,65,0.2);
            border: 2px solid #5D4037;
            transform-style: preserve-3d;
        }
        
        /* Fjer p√• vingen */
        #bird .wing::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 3px,
                rgba(0,0,0,0.1) 3px,
                rgba(0,0,0,0.1) 4px
            );
            border-radius: inherit;
        }

        @keyframes flapWing3D {
            0%, 100% { 
                transform: perspective(500px) rotateX(-10deg) rotateZ(-15deg) translateZ(5px);
            }
            50% { 
                transform: perspective(500px) rotateX(5deg) rotateZ(5deg) translateZ(-3px);
            }
        }

        /* Hale - 3D kraftig √∏rnehale */
        #bird .tail {
            position: absolute;
            width: 22px;
            height: 18px;
            background: linear-gradient(135deg, #6D4C41 0%, #4E342E 50%, #3E2723 100%);
            border-radius: 0 60% 60% 0;
            left: -12px;
            top: 10px;
            clip-path: polygon(0 40%, 100% 0, 100% 100%, 0 60%);
            box-shadow: 
                -5px 0 10px rgba(0,0,0,0.5),
                -2px 0 5px rgba(0,0,0,0.3),
                inset 2px 0 4px rgba(0,0,0,0.3);
            border-left: 2px solid #5D4037;
            transform-style: preserve-3d;
            transform: perspective(500px) rotateY(10deg);
        }
        
        /* Fjer p√• halen */
        #bird .tail::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                -45deg,
                transparent,
                transparent 3px,
                rgba(0,0,0,0.15) 3px,
                rgba(0,0,0,0.15) 4px
            );
            border-radius: inherit;
        }

        .pipe {
            position: absolute;
            width: 80px;
            background: linear-gradient(90deg, #8B4513 0%, #A0522D 50%, #8B4513 100%);
            border-radius: 8px;
            box-shadow: 
                inset -5px 0 10px rgba(0,0,0,0.3),
                inset 5px 0 10px rgba(255,255,255,0.1),
                0 0 20px rgba(0,0,0,0.5);
            border: 2px solid #654321;
        }
        
        .pipe::before {
            content: '';
            position: absolute;
            left: 10%;
            width: 15%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            border-radius: 4px;
        }
        
        .pipe::after {
            content: '';
            position: absolute;
            right: 10%;
            width: 10%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(0,0,0,0.2), transparent);
            border-radius: 4px;
        }

        .pipe-top {
            top: 0;
        }

        .pipe-bottom {
            bottom: 0;
        }

        #score {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 48px;
            font-weight: bold;
            color: white;
            text-shadow: 3px 3px 0 #000;
            z-index: 10;
        }

        #gameOver {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, rgba(255,107,107,0.95) 0%, rgba(255,59,59,0.95) 100%);
            color: white;
            padding: 50px 60px;
            border-radius: 20px;
            text-align: center;
            display: none;
            z-index: 20;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 3px solid rgba(255,255,255,0.3);
            animation: gameOverPop 0.5s ease-out;
        }

        #gameOver h2 {
            font-size: 56px;
            margin-bottom: 20px;
            color: white;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.5);
            animation: shake 0.5s ease-in-out;
        }

        #gameOver p {
            font-size: 28px;
            margin-bottom: 15px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        #gameOver button {
            font-size: 24px;
            padding: 15px 50px;
            background: linear-gradient(135deg, #5cb85c 0%, #4cae4c 100%);
            border: none;
            border-radius: 50px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            box-shadow: 0 6px 0 #3d8b3d, 0 10px 20px rgba(0,0,0,0.3);
            transition: all 0.2s;
            margin-top: 20px;
        }

        #gameOver button:hover {
            transform: translateY(-3px);
            box-shadow: 0 9px 0 #3d8b3d, 0 13px 25px rgba(0,0,0,0.4);
        }
        
        #gameOver button:active {
            transform: translateY(3px);
            box-shadow: 0 3px 0 #3d8b3d, 0 5px 10px rgba(0,0,0,0.3);
        }
        
        @keyframes gameOverPop {
            0% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.5);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.1);
            }
            100% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-10px); }
            20%, 40%, 60%, 80% { transform: translateX(10px); }
        }

        #introScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 50;
            animation: fadeIn 0.5s ease-in;
        }
        
        .intro-content {
            text-align: center;
            color: white;
            animation: slideUp 0.8s ease-out;
        }
        
        .intro-bird {
            font-size: 120px;
            animation: bounce 1s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        .intro-title {
            font-size: 72px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 4px 4px 8px rgba(0,0,0,0.3);
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .intro-subtitle {
            font-size: 28px;
            margin-bottom: 40px;
            opacity: 0.9;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .intro-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            margin-bottom: 40px;
        }
        
        .intro-stat {
            background: rgba(255,255,255,0.2);
            padding: 20px 30px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 2px solid rgba(255,255,255,0.3);
            min-width: 150px;
        }
        
        .stat-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 16px;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .start-button {
            background: linear-gradient(135deg, #5cb85c 0%, #4cae4c 100%);
            border: none;
            padding: 20px 60px;
            font-size: 28px;
            font-weight: bold;
            color: white;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 8px 0 #3d8b3d, 0 12px 20px rgba(0,0,0,0.3);
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .start-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 0 #3d8b3d, 0 16px 25px rgba(0,0,0,0.4);
        }
        
        .start-button:active {
            transform: translateY(4px);
            box-shadow: 0 4px 0 #3d8b3d, 0 6px 10px rgba(0,0,0,0.3);
        }
        
        .button-icon {
            font-size: 32px;
            animation: pulse 1.5s ease-in-out infinite;
        }
        
        .intro-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .intro-menu-button {
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.4);
            padding: 12px 25px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            border-radius: 15px;
            cursor: pointer;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            box-shadow: 0 4px 0 rgba(0,0,0,0.2);
        }
        
        .intro-menu-button:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-3px);
            box-shadow: 0 7px 0 rgba(0,0,0,0.2);
        }
        
        .intro-menu-button:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 rgba(0,0,0,0.2);
        }
        
        .intro-menu-button.admin-only {
            background: linear-gradient(135deg, rgba(102,126,234,0.3) 0%, rgba(118,75,162,0.3) 100%);
            border-color: gold;
        }
        
        .intro-tip {
            font-size: 18px;
            opacity: 0.7;
            animation: blink 2s ease-in-out infinite;
            margin-top: 20px;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }
        
        @keyframes blink {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 0.3; }
        }
        
        #startScreen {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            z-index: 20;
            width: 80%;
            max-width: 800px;
        }

        #startScreen h1 {
            font-size: 72px;
            margin-bottom: 10px;
            text-shadow: 4px 4px 0 #000;
            animation: bounce 1s ease-in-out infinite;
        }

        #startScreen .subtitle {
            font-size: 24px;
            margin-bottom: 40px;
            text-shadow: 2px 2px 0 #000;
            opacity: 0.9;
        }

        .level-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .level-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px 40px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 8px 0 rgba(0,0,0,0.3);
            text-align: center;
        }

        .level-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 0 rgba(0,0,0,0.3);
        }

        .level-card:active {
            transform: translateY(-5px);
            box-shadow: 0 10px 0 rgba(0,0,0,0.3);
        }

        .level-card.easy {
            border: 5px solid #5cb85c;
        }

        .level-card.medium {
            border: 5px solid #f0ad4e;
        }

        .level-card.hard {
            border: 5px solid #d9534f;
        }
        
        .level-card.custom {
            border: 5px solid #9370DB;
            background: linear-gradient(135deg, rgba(147,112,219,0.1) 0%, rgba(138,43,226,0.1) 100%);
        }

        .level-card h2 {
            font-size: 36px;
            margin-bottom: 10px;
            color: #333;
        }

        .level-card.easy h2 { color: #5cb85c; }
        .level-card.medium h2 { color: #f0ad4e; }
        .level-card.hard h2 { color: #d9534f; }
        .level-card.custom h2 { color: #9370DB; }

        .level-card p {
            font-size: 16px;
            color: #666;
            margin: 5px 0;
            text-shadow: none;
        }

        .level-card .emoji {
            font-size: 48px;
            margin-bottom: 10px;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        #skinSelector {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 40px;
            border-radius: 20px;
            z-index: 30;
            display: none;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        /* Scrollbar styling til skin selector */
        #skinSelector::-webkit-scrollbar {
            width: 12px;
        }
        
        #skinSelector::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
        }
        
        #skinSelector::-webkit-scrollbar-thumb {
            background: #4ec0ca;
            border-radius: 10px;
            border: 2px solid rgba(0,0,0,0.2);
        }
        
        #skinSelector::-webkit-scrollbar-thumb:hover {
            background: #5ed0da;
        }

        #skinSelector h2 {
            color: white;
            font-size: 48px;
            text-align: center;
            margin-bottom: 30px;
            text-shadow: 3px 3px 0 #000;
        }

        .skins-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .skin-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 4px solid transparent;
            position: relative;
        }

        .skin-card:hover {
            transform: scale(1.1);
            box-shadow: 0 10px 30px rgba(255,255,255,0.3);
        }

        .skin-card.selected {
            border-color: #5cb85c;
            box-shadow: 0 0 20px #5cb85c;
        }

        .skin-card.locked {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .skin-preview {
            width: 80px;
            height: 60px;
            margin: 0 auto 10px;
            border-radius: 50%;
            position: relative;
        }

        .skin-card h3 {
            font-size: 18px;
            color: #333;
            margin-bottom: 5px;
        }

        .skin-card .price {
            font-size: 14px;
            color: #f0ad4e;
            font-weight: bold;
        }

        .skin-card .unlocked {
            color: #5cb85c;
            font-weight: bold;
        }

        .lock-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
        }

        #skinSelector button {
            display: block;
            margin: 20px auto 0;
            padding: 15px 40px;
            font-size: 20px;
            background: #5cb85c;
            border: none;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s;
        }

        #skinSelector button:hover {
            background: #4a9d4a;
        }

        #coinsDisplay {
            position: absolute;
            top: 130px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            padding: 10px 20px;
            border-radius: 10px;
            color: #f0ad4e;
            font-size: 24px;
            font-weight: bold;
            z-index: 15;
        }

        .skin-button {
            position: absolute;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.9);
            border: 3px solid #333;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            z-index: 15;
            transition: all 0.3s;
        }

        .skin-button:hover {
            transform: scale(1.1);
            background: white;
        }

        .settings-button {
            position: absolute;
            top: 70px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(100,200,255,0.9);
            border: 3px solid #333;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            z-index: 15;
            transition: all 0.3s;
        }

        .settings-button:hover {
            transform: scale(1.1);
            background: rgba(100,200,255,1);
        }
        
        .custom-button {
            position: absolute;
            top: 120px;
            right: 20px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #9370DB 0%, #8A2BE2 100%);
            border: 3px solid #FFD700;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            z-index: 15;
            transition: all 0.3s;
            color: white;
            box-shadow: 0 0 15px rgba(147, 112, 219, 0.5);
        }
        
        .custom-button:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px rgba(147, 112, 219, 0.8);
        }

        .admin-button-main {
            position: absolute;
            top: 170px;
            right: 20px;
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: 3px solid gold;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            z-index: 15;
            transition: all 0.3s;
            color: gold;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        .admin-button-main:hover {
            transform: scale(1.1);
            box-shadow: 0 0 25px gold;
        }

        #adminPanel {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 40px;
            border-radius: 20px;
            z-index: 40;
            display: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 3px solid gold;
            max-height: 80vh;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        /* Scrollbar styling til admin panel */
        #adminPanel::-webkit-scrollbar {
            width: 12px;
        }
        
        #adminPanel::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        
        #adminPanel::-webkit-scrollbar-thumb {
            background: gold;
            border-radius: 10px;
            border: 2px solid rgba(0,0,0,0.2);
        }
        
        #adminPanel::-webkit-scrollbar-thumb:hover {
            background: #FFD700;
        }

        #adminPanel h2 {
            color: gold;
            font-size: 36px;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .admin-button {
            display: block;
            width: 100%;
            margin: 10px 0;
            padding: 15px;
            font-size: 18px;
            background: rgba(255,255,255,0.2);
            border: 2px solid gold;
            border-radius: 10px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s;
        }

        .admin-button:hover {
            background: rgba(255,255,255,0.3);
            transform: scale(1.05);
        }

        .admin-input {
            width: 100%;
            padding: 10px;
            margin: 10px 0;
            font-size: 16px;
            border: 2px solid gold;
            border-radius: 5px;
            background: rgba(255,255,255,0.9);
        }

        .admin-badge {
            position: absolute;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: gold;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            border: 2px solid gold;
            z-index: 15;
            display: none;
            animation: glow 2s ease-in-out infinite;
        }

        #settingsMenu {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #4ec0ca 0%, #667eea 100%);
            padding: 40px;
            border-radius: 20px;
            z-index: 40;
            display: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 3px solid #333;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        /* Scrollbar styling til settings menu */
        #settingsMenu::-webkit-scrollbar {
            width: 12px;
        }
        
        #settingsMenu::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        
        #settingsMenu::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.5);
            border-radius: 10px;
            border: 2px solid rgba(0,0,0,0.2);
        }
        
        #settingsMenu::-webkit-scrollbar-thumb:hover {
            background: rgba(255,255,255,0.7);
        }

        #settingsMenu h2 {
            color: white;
            font-size: 36px;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        #settingsMenu h3 {
            color: white;
            font-size: 24px;
            margin-bottom: 15px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .setting-section {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .color-picker-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin-top: 10px;
        }

        .color-option {
            width: 60px;
            height: 60px;
            border-radius: 10px;
            cursor: pointer;
            border: 3px solid white;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .color-option:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0,0,0,0.5);
        }

        .color-option.selected {
            border-color: gold;
            box-shadow: 0 0 20px gold;
        }

        .setting-toggle {
            display: flex;
            align-items: center;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s;
        }

        .setting-toggle:hover {
            background: rgba(255,255,255,0.2);
        }

        .setting-toggle input[type="checkbox"] {
            width: 50px;
            height: 25px;
            margin-right: 15px;
            cursor: pointer;
        }

        .setting-toggle span {
            color: white;
            font-size: 18px;
            font-weight: bold;
        }
        
        #customSettings {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #9370DB 0%, #8A2BE2 100%);
            padding: 40px;
            border-radius: 20px;
            z-index: 40;
            display: none;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            border: 3px solid #FFD700;
            max-width: 600px;
            max-height: 85vh;
            overflow-y: auto;
            overflow-x: hidden;
        }
        
        /* Scrollbar styling til custom settings */
        #customSettings::-webkit-scrollbar {
            width: 12px;
        }
        
        #customSettings::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        
        #customSettings::-webkit-scrollbar-thumb {
            background: #FFD700;
            border-radius: 10px;
            border: 2px solid rgba(0,0,0,0.2);
        }
        
        #customSettings::-webkit-scrollbar-thumb:hover {
            background: #FFC700;
        }
        
        #customSettings h2 {
            color: white;
            font-size: 36px;
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }
        
        #customSettings h3 {
            color: white;
            font-size: 20px;
            margin-bottom: 10px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }
        
        #customSettings input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: rgba(255,255,255,0.3);
            outline: none;
            margin: 10px 0;
        }
        
        #customSettings input[type="range"]::-webkit-slider-thumb {
            appearance: none;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
        }
        
        #customSettings input[type="range"]::-moz-range-thumb {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            background: #FFD700;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(255,215,0,0.5);
            border: none;
        }
        
        #customSettings p {
            color: white;
            font-size: 16px;
            margin-top: 5px;
            text-align: center;
            font-weight: bold;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 10px gold; }
            50% { box-shadow: 0 0 20px gold, 0 0 30px gold; }
        }
        
        @keyframes fadeInOut {
            0% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
            10% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            90% { opacity: 1; transform: translate(-50%, -50%) scale(1); }
            100% { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
        }

        #adminMessage {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 28px;
            font-weight: bold;
            z-index: 50;
            display: none;
            animation: slideDown 0.5s ease-out;
            border-bottom: 5px solid gold;
            box-shadow: 0 5px 20px rgba(0,0,0,0.5);
        }

        @keyframes slideDown {
            from { transform: translateY(-100%); }
            to { transform: translateY(0); }
        }

        .disco-mode {
            animation: discoBackground 0.5s infinite;
        }

        @keyframes discoBackground {
            0% { background: linear-gradient(45deg, #ff0000, #ff7700); }
            14% { background: linear-gradient(45deg, #ff7700, #ffff00); }
            28% { background: linear-gradient(45deg, #ffff00, #00ff00); }
            42% { background: linear-gradient(45deg, #00ff00, #0077ff); }
            57% { background: linear-gradient(45deg, #0077ff, #0000ff); }
            71% { background: linear-gradient(45deg, #0000ff, #ff00ff); }
            85% { background: linear-gradient(45deg, #ff00ff, #ff0000); }
            100% { background: linear-gradient(45deg, #ff0000, #ff7700); }
        }

        .disco-lights {
            position: absolute;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            opacity: 0.6;
            animation: discoLights 2s infinite;
            pointer-events: none;
        }

        @keyframes discoLights {
            0%, 100% { 
                transform: scale(0.5) translate(0, 0);
                opacity: 0.8;
            }
            50% { 
                transform: scale(1.5) translate(50px, 50px);
                opacity: 0.3;
            }
        }

        .disco-bird {
            animation: discoBirdSpin 1s infinite linear;
        }

        @keyframes discoBirdSpin {
            0% { filter: hue-rotate(0deg) brightness(1.5); }
            100% { filter: hue-rotate(360deg) brightness(1.5); }
        }

        .cloud {
            position: absolute;
            background: white;
            border-radius: 100px;
            opacity: 0.7;
        }

        #loginScreen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .login-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 400px;
            width: 90%;
        }

        .login-container h1 {
            color: #667eea;
            text-align: center;
            margin-bottom: 10px;
            font-size: 48px;
        }

        .login-container h2 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
            font-size: 24px;
        }

        .login-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }
        
        #profileSelect {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #667eea;
            font-size: 16px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        #profileSelect:hover {
            border-color: #764ba2;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }
        
        #profileSelect:focus {
            outline: none;
            border-color: #764ba2;
            box-shadow: 0 0 15px rgba(102, 126, 234, 0.5);
        }

        .login-tab {
            flex: 1;
            padding: 15px;
            background: #f0f0f0;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            color: #666;
        }

        .login-tab.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .login-form {
            display: none;
        }

        .login-form.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
            font-size: 16px;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
        }

        .login-button:hover {
            transform: scale(1.05);
        }

        .error-message {
            color: #ff4444;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }

        .success-message {
            color: #44ff44;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }

        .profile-display {
            position: absolute;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255,255,255,0.9);
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            color: #667eea;
            z-index: 15;
            border: 3px solid #667eea;
        }

        .logout-button {
            position: absolute;
            bottom: 20px;
            left: 20px;
            padding: 10px 20px;
            background: rgba(255,0,0,0.8);
            border: 2px solid white;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            z-index: 15;
            transition: all 0.3s;
        }

        .logout-button:hover {
            background: rgba(255,0,0,1);
            transform: scale(1.1);
        }
        /* Mobile Responsive Design */
        @media (max-width: 768px) {
            /* St√∏rre knapper til touch */
            button {
                min-height: 50px;
                font-size: 18px;
                padding: 15px 25px;
            }
            
            .admin-button, .intro-menu-button {
                min-height: 55px;
                font-size: 20px;
            }
            
            /* Mindre padding i menus */
            #adminPanel, #settingsMenu, #customSettings {
                padding: 20px;
                max-width: 95%;
                max-height: 90vh;
            }
            
            #loginScreen {
                padding: 20px;
                max-width: 95%;
            }
            
            #introScreen {
                padding: 20px;
            }
            
            /* St√∏rre tekst */
            h1 {
                font-size: 48px;
            }
            
            h2 {
                font-size: 32px;
            }
            
            /* Mindre fugl p√• mobil */
            #bird {
                width: 40px;
                height: 30px;
            }
            
            /* Mindre r√∏r bredde */
            .pipe {
                width: 60px;
            }
            
            /* St√∏rre score display */
            #score {
                font-size: 48px;
            }
            
            #coinsDisplay {
                font-size: 28px;
            }
            
            /* Vejr kontrol grid */
            #adminPanel h3 + div {
                grid-template-columns: 1fr 1fr;
                gap: 8px;
            }
            
            /* Skin grid */
            .skins-grid {
                grid-template-columns: repeat(3, 1fr);
                gap: 10px;
            }
            
            .skin-item {
                font-size: 40px;
                padding: 15px;
            }
        }
        
        @media (max-width: 480px) {
            /* Ekstra sm√• sk√¶rme */
            h1 {
                font-size: 36px;
            }
            
            button {
                font-size: 16px;
                padding: 12px 20px;
            }
            
            .skins-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            #adminPanel, #settingsMenu, #customSettings {
                padding: 15px;
            }
        }
        
        /* Landscape mode p√• mobil */
        @media (max-height: 500px) and (orientation: landscape) {
            #adminPanel, #settingsMenu, #customSettings {
                max-height: 95vh;
                padding: 15px;
            }
            
            h2 {
                font-size: 24px;
                margin-bottom: 10px;
            }
            
            button {
                padding: 10px 15px;
                margin: 5px 0;
            }
        }
    </style>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database-compat.js"></script>
</head>
<body>
    <div id="loginScreen">
        <div class="login-container">
            <h1>ü¶Ö</h1>
            <h2>Flappy Eagle</h2>
            
            <div class="login-tabs">
                <button class="login-tab active" onclick="showLoginTab('login')">Log Ind</button>
                <button class="login-tab" onclick="showLoginTab('register')">Opret Profil</button>
            </div>
            
            <form class="login-form active" id="loginForm">
                <div class="form-group">
                    <label>V√¶lg Profil:</label>
                    <select id="profileSelect" style="width: 100%; padding: 10px; border-radius: 5px; border: 2px solid #4CAF50; font-size: 16px; background: white;">
                        <option value="">-- Eller skriv brugernavn --</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Eller Indtast Brugernavn:</label>
                    <input type="text" id="loginUsername" placeholder="Indtast brugernavn">
                </div>
                <div class="form-group">
                    <label>Kode:</label>
                    <input type="password" id="loginPassword" required placeholder="Indtast kode">
                </div>
                <button type="submit" class="login-button">üîë Log Ind</button>
                <div id="loginError" class="error-message"></div>
            </form>
            
            <form class="login-form" id="registerForm">
                <div class="form-group">
                    <label>V√¶lg Brugernavn:</label>
                    <input type="text" id="registerUsername" required placeholder="V√¶lg et brugernavn" minlength="3">
                </div>
                <div class="form-group">
                    <label>V√¶lg Kode:</label>
                    <input type="password" id="registerPassword" required placeholder="V√¶lg en kode" minlength="4">
                </div>
                <div class="form-group">
                    <label>Gentag Kode:</label>
                    <input type="password" id="registerPasswordConfirm" required placeholder="Gentag din kode">
                </div>
                <button type="submit" class="login-button">‚ú® Opret Profil</button>
                <div id="registerError" class="error-message"></div>
                <div id="registerSuccess" class="success-message"></div>
            </form>
        </div>
    </div>

    <div id="gameContainer">
        <div class="profile-display" id="profileDisplay">üë§ Bruger</div>
        <button class="logout-button" onclick="handleLogout()">üö™ Log Ud</button>
        <div id="adminMessage"></div>
        <div class="admin-badge" id="adminBadge">üëë ADMIN</div>
        <button class="skin-button" onclick="openSkinSelector()">üé® Skins</button>
        <button class="settings-button" onclick="openSettings()">‚öôÔ∏è Indstillinger</button>
        <button class="custom-button" onclick="openCustomSettings()">‚öôÔ∏è Custom</button>
        <button class="admin-button-main" onclick="openAdminPanel()">üëë Admin</button>
        <div id="coinsDisplay">ü™ô <span id="coins">0</span></div>
        <div id="score">0</div>
        <div id="bird">
            <div class="tail"></div>
            <div class="wing"></div>
            <div class="beak"></div>
        </div>
        
        <div id="introScreen">
            <div class="intro-content">
                <div class="intro-bird">ü¶Ö</div>
                <h1 class="intro-title">Flappy Eagle</h1>
                <p class="intro-subtitle">Velkommen tilbage, <span id="introUsername">Spiller</span>!</p>
                <div class="intro-stats">
                    <div class="intro-stat">
                        <div class="stat-icon">üèÜ</div>
                        <div class="stat-label">High Score</div>
                        <div class="stat-value" id="introHighScore">0</div>
                    </div>
                    <div class="intro-stat">
                        <div class="stat-icon">ü™ô</div>
                        <div class="stat-label">M√∏nter</div>
                        <div class="stat-value" id="introCoins">0</div>
                    </div>
                </div>
                <button class="start-button" onclick="startGameFromIntro()">
                    <span class="button-icon">üöÄ</span>
                    <span class="button-text">START SPIL</span>
                </button>
                
                <div class="intro-buttons">
                    <button class="intro-menu-button" onclick="openSkinSelector()">
                        üé® Skins
                    </button>
                    <button class="intro-menu-button" onclick="openSettings()">
                        ‚öôÔ∏è Indstillinger
                    </button>
                    <button class="intro-menu-button" onclick="openCustomSettings()">
                        ‚öôÔ∏è Custom
                    </button>
                    <button class="intro-menu-button admin-only" onclick="openAdminPanel()" id="introAdminButton">
                        üëë Admin
                    </button>
                    <button class="intro-menu-button" onclick="openHighscores()" style="background: linear-gradient(135deg, rgba(255,215,0,0.3) 0%, rgba(255,165,0,0.3) 100%); border-color: gold;">
                        üèÜ Global Highscore
                    </button>
                </div>
                
                <p class="intro-tip">üí° Klik eller tryk mellemrum for at flyve</p>
            </div>
        </div>
        
        <div id="startScreen" style="display: none;">
            <h1>ü¶Ö Flappy Eagle</h1>
            <p class="subtitle">Klik for at starte!</p>
            <p style="font-size: 18px; opacity: 0.8;">üí° Klik eller tryk mellemrum for at flyve</p>
        </div>

        <div id="gameOver">
            <h2>üíÄ GAME OVER! üíÄ</h2>
            <p style="font-size: 20px; opacity: 0.9; margin-bottom: 25px;">Du d√∏de!</p>
            <div style="background: rgba(255,255,255,0.2); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
                <p style="font-size: 18px; margin-bottom: 10px; opacity: 0.8;">Din Score:</p>
                <p style="font-size: 48px; font-weight: bold; margin: 0;"><span id="finalScore">0</span></p>
            </div>
            <p style="color: #FFD700; font-size: 24px; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">ü™ô +<span id="coinsEarned">0</span> M√∏nter!</p>
            <div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;">
                <button onclick="restartGame()">üöÄ SPIL IGEN</button>
                <button onclick="backToIntro()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">üè† TILBAGE TIL START</button>
            </div>
        </div>

        <div id="skinSelector">
            <h2>üé® V√¶lg Din Skin</h2>
            <div class="skins-grid" id="skinsGrid"></div>
            <button onclick="closeSkinSelector()">Luk</button>
        </div>

        <div id="adminPanel">
            <h2>üëë ADMIN PANEL</h2>
            <button class="admin-button" onclick="adminSendMessage()">üì¢ Send Besked</button>
            <button class="admin-button" onclick="adminShareGame()">üîó Del Spil Link</button>
            <button class="admin-button" onclick="adminToggleDisco()">ü•≥ Disko Mode</button>
            <button class="admin-button" onclick="adminChangePipeColor()">üé® Skift R√∏r Farve</button>
            <button class="admin-button" onclick="adminGiveCoinsToPlayer()">üí∞ Giv M√∏nter Til Spiller</button>
            <button class="admin-button" onclick="adminUnlockAll()">üîì L√•s Alle Skins Op</button>
            <button class="admin-button" onclick="adminGodMode()">‚ú® Gud Mode (Ud√∏delig)</button>
            <button class="admin-button" onclick="adminResetProgress()">üóëÔ∏è Nulstil Alt</button>
            <button class="admin-button" onclick="adminGenerateCode()">üé´ Generer Admin Kode</button>
            <div id="generatedCode" style="color: gold; text-align: center; margin: 10px 0; font-size: 20px;"></div>
            
            <h3 style="color: #87CEEB; margin-top: 20px; margin-bottom: 10px;">üå§Ô∏è VEJR KONTROL</h3>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button class="admin-button" onclick="setWeather('day')">‚òÄÔ∏è Dag</button>
                <button class="admin-button" onclick="setWeather('night')">üåô Nat</button>
                <button class="admin-button" onclick="setWeather('rain')">üåßÔ∏è Regn</button>
                <button class="admin-button" onclick="setWeather('storm')">‚õàÔ∏è Torden</button>
                <button class="admin-button" onclick="setWeather('snow')">‚ùÑÔ∏è Sne</button>
                <button class="admin-button" onclick="setWeather('clear')">üîÑ Normal</button>
            </div>
            
            <button class="admin-button" style="background: rgba(255,0,0,0.3); margin-top: 15px;" onclick="closeAdminPanel()">Luk</button>
        </div>

        <div id="settingsMenu">
            <h2>‚öôÔ∏è Indstillinger</h2>
            
            <div class="setting-section">
                <h3>üé® R√∏r Farve</h3>
                <div class="color-picker-grid">
                    <div class="color-option" style="background: #8B4513;" onclick="changePipeColor('#8B4513')" title="Brun (Standard)"></div>
                    <div class="color-option" style="background: #228B22;" onclick="changePipeColor('#228B22')" title="Gr√∏n"></div>
                    <div class="color-option" style="background: #FF4500;" onclick="changePipeColor('#FF4500')" title="R√∏d"></div>
                    <div class="color-option" style="background: #1E90FF;" onclick="changePipeColor('#1E90FF')" title="Bl√•"></div>
                    <div class="color-option" style="background: #FFD700;" onclick="changePipeColor('#FFD700')" title="Guld"></div>
                    <div class="color-option" style="background: #9370DB;" onclick="changePipeColor('#9370DB')" title="Lilla"></div>
                    <div class="color-option" style="background: #FF1493;" onclick="changePipeColor('#FF1493')" title="Pink"></div>
                    <div class="color-option" style="background: #00CED1;" onclick="changePipeColor('#00CED1')" title="Cyan"></div>
                    <div class="color-option" style="background: #FF8C00;" onclick="changePipeColor('#FF8C00')" title="Orange"></div>
                    <div class="color-option" style="background: #2F4F4F;" onclick="changePipeColor('#2F4F4F')" title="Gr√•"></div>
                </div>
            </div>
            
            <div class="setting-section">
                <h3>‚ö° Spil Indstillinger</h3>
                <label class="setting-toggle">
                    <input type="checkbox" id="movingPipesToggle" checked onchange="toggleMovingPipes()">
                    <span>Bev√¶gelige R√∏r (efter 5 point)</span>
                </label>
                <label class="setting-toggle">
                    <input type="checkbox" id="speedIncreaseToggle" onchange="toggleSpeedIncrease()">
                    <span>Stigende Hastighed</span>
                </label>
            </div>
            
            <button onclick="closeSettings()" style="margin-top: 20px;">Luk</button>
        </div>
        
        <div id="customSettings">
            <h2>‚öôÔ∏è Tilpas Din Sv√¶rhedsgrad</h2>
            
            <div class="setting-section">
                <h3>üìç Afstand Mellem R√∏r</h3>
                <input type="range" id="pipeFrequencySlider" min="60" max="180" value="90" step="10">
                <p>V√¶rdi: <span id="pipeFrequencyValue">90</span> (St√∏rre = Mere afstand)</p>
            </div>
            
            <div class="setting-section">
                <h3>üï≥Ô∏è Hul St√∏rrelse</h3>
                <input type="range" id="pipeGapSlider" min="150" max="400" value="250" step="10">
                <p>V√¶rdi: <span id="pipeGapValue">250</span>px (St√∏rre = Lettere)</p>
            </div>
            
            <div class="setting-section">
                <h3>üöÄ R√∏r Hastighed</h3>
                <input type="range" id="pipeSpeedSlider" min="2" max="8" value="4" step="0.5">
                <p>V√¶rdi: <span id="pipeSpeedValue">4</span> (St√∏rre = Hurtigere)</p>
            </div>
            
            <div class="setting-section">
                <h3>üåç Tyngdekraft</h3>
                <input type="range" id="gravitySlider" min="0.3" max="1.0" value="0.6" step="0.05">
                <p>V√¶rdi: <span id="gravityValue">0.6</span> (St√∏rre = Sv√¶rere)</p>
            </div>
            
            <div class="setting-section">
                <h3>ü¶Ö Hop Styrke</h3>
                <input type="range" id="jumpStrengthSlider" min="-15" max="-5" value="-10" step="0.5">
                <p>V√¶rdi: <span id="jumpStrengthValue">-10</span> (Mindre = St√¶rkere hop)</p>
            </div>
            
            <button onclick="startCustomGame()" style="margin-top: 20px; background: #5cb85c; font-size: 20px; padding: 15px 30px;">üéÆ Start Spil!</button>
            <button onclick="closeCustomSettings()" style="margin-top: 10px;">Tilbage</button>
        </div>
    </div>

    <!-- Global Highscore Modal -->
    <div id="highscoreModal" style="display: none; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 40px; border-radius: 20px; z-index: 50; box-shadow: 0 20px 60px rgba(0,0,0,0.5); border: 3px solid gold; max-width: 600px; max-height: 80vh; overflow-y: auto;">
        <h2 style="color: gold; font-size: 36px; text-align: center; margin-bottom: 20px; text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">üèÜ Global Highscore</h2>
        
        <div id="highscoreList" style="background: rgba(255,255,255,0.1); padding: 20px; border-radius: 15px; margin-bottom: 20px;">
            <div style="color: white; text-align: center; padding: 20px;">
                <div style="font-size: 48px; margin-bottom: 10px;">‚è≥</div>
                <div>Indl√¶ser highscores...</div>
            </div>
        </div>
        
        <div style="background: rgba(255,255,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
            <div style="color: white; font-size: 18px; text-align: center;">
                <strong>üéØ Din bedste score:</strong> <span id="yourBestScore" style="color: gold; font-size: 24px; font-weight: bold;">0</span>
            </div>
        </div>
        
        <button onclick="closeHighscores()" style="display: block; width: 100%; padding: 15px; font-size: 20px; background: rgba(255,255,255,0.2); border: 2px solid gold; border-radius: 10px; color: white; cursor: pointer; font-weight: bold;">‚Üê Tilbage</button>
    </div>

    <script>
        // Global funktion til login tabs (skal v√¶re tilg√¶ngelig fra HTML onclick)
        function showLoginTab(tab) {
            document.querySelectorAll('.login-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.login-form').forEach(f => f.classList.remove('active'));
            
            if (tab === 'login') {
                document.querySelectorAll('.login-tab')[0].classList.add('active');
                document.getElementById('loginForm').classList.add('active');
            } else {
                document.querySelectorAll('.login-tab')[1].classList.add('active');
                document.getElementById('registerForm').classList.add('active');
            }
            
            // Clear errors
            try {
                document.getElementById('loginError').textContent = '';
                document.getElementById('registerError').textContent = '';
                document.getElementById('registerSuccess').textContent = '';
            } catch(e) {}
        }
        
        // ========================================
        // FIREBASE KONFIGURATION & HIGHSCORE
        // ========================================
        
        // Firebase configuration - VIGTIGT: Udskift med dine egne Firebase credentials!
        // G√• til https://console.firebase.google.com/ og opret et projekt
        // Aktiver Realtime Database og kopier din config her:
        const firebaseConfig = {
            apiKey: "DIN-API-KEY",
            authDomain: "dit-projekt.firebaseapp.com",
            databaseURL: "https://dit-projekt.firebaseio.com",
            projectId: "dit-projekt",
            storageBucket: "dit-projekt.appspot.com",
            messagingSenderId: "123456789",
            appId: "1:123456789:web:abc123"
        };
        
        let firebaseInitialized = false;
        let database = null;
        
        // Initialiser Firebase
        try {
            if (typeof firebase !== 'undefined') {
                firebase.initializeApp(firebaseConfig);
                database = firebase.database();
                firebaseInitialized = true;
                console.log('‚úÖ Firebase initialiseret!');
            }
        } catch (error) {
            console.warn('‚ö†Ô∏è Firebase kunne ikke initialiseres:', error);
            console.log('üí° Tip: Opdater firebaseConfig med dine egne credentials fra Firebase Console');
        }
        
        // Upload score til Firebase
        function uploadScoreToFirebase(username, score) {
            if (!firebaseInitialized || !database) {
                console.log('‚ö†Ô∏è Firebase ikke tilg√¶ngelig - score ikke uploaded');
                return;
            }
            
            try {
                const scoreRef = database.ref('highscores/' + username.replace(/[.#$\[\]]/g, '_'));
                
                // Hent eksisterende score
                scoreRef.once('value').then((snapshot) => {
                    const existingData = snapshot.val();
                    const existingScore = existingData ? existingData.score : 0;
                    
                    // Kun upload hvis ny score er h√∏jere
                    if (score > existingScore) {
                        scoreRef.set({
                            username: username,
                            score: score,
                            timestamp: Date.now(),
                            date: new Date().toISOString()
                        }).then(() => {
                            console.log('‚úÖ Score uploaded til Firebase!');
                        }).catch((error) => {
                            console.error('‚ùå Fejl ved upload:', error);
                        });
                    }
                });
            } catch (error) {
                console.error('‚ùå Firebase upload fejl:', error);
            }
        }
        
        // Hent top 10 highscores
        function loadHighscores() {
            if (!firebaseInitialized || !database) {
                const highscoreList = document.getElementById('highscoreList');
                highscoreList.innerHTML = `
                    <div style="color: white; text-align: center; padding: 20px;">
                        <div style="font-size: 48px; margin-bottom: 10px;">‚ö†Ô∏è</div>
                        <div style="font-size: 18px; margin-bottom: 10px;">Firebase ikke konfigureret</div>
                        <div style="font-size: 14px; opacity: 0.8;">
                            For at aktivere global highscore:<br>
                            1. Opret et Firebase projekt p√• console.firebase.google.com<br>
                            2. Aktiver Realtime Database<br>
                            3. Opdater firebaseConfig i koden med dine credentials
                        </div>
                    </div>
                `;
                return;
            }
            
            const highscoreList = document.getElementById('highscoreList');
            highscoreList.innerHTML = '<div style="color: white; text-align: center; padding: 20px;"><div style="font-size: 48px;">‚è≥</div><div>Indl√¶ser...</div></div>';
            
            try {
                database.ref('highscores').orderByChild('score').limitToLast(10).once('value').then((snapshot) => {
                    const scores = [];
                    snapshot.forEach((childSnapshot) => {
                        scores.push(childSnapshot.val());
                    });
                    
                    // Sorter efter score (h√∏jest f√∏rst)
                    scores.sort((a, b) => b.score - a.score);
                    
                    if (scores.length === 0) {
                        highscoreList.innerHTML = `
                            <div style="color: white; text-align: center; padding: 20px;">
                                <div style="font-size: 48px; margin-bottom: 10px;">üéÆ</div>
                                <div>Ingen scores endnu!</div>
                                <div style="font-size: 14px; opacity: 0.8; margin-top: 10px;">V√¶r den f√∏rste til at s√¶tte en rekord!</div>
                            </div>
                        `;
                        return;
                    }
                    
                    let html = '<div style="color: white;">';
                    scores.forEach((data, index) => {
                        const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
                        const isCurrentUser = data.username === currentUser;
                        const highlight = isCurrentUser ? 'background: rgba(255,215,0,0.2); border: 2px solid gold;' : 'background: rgba(255,255,255,0.05);';
                        
                        html += `
                            <div style="${highlight} padding: 15px; margin: 10px 0; border-radius: 10px; display: flex; justify-content: space-between; align-items: center;">
                                <div style="display: flex; align-items: center; gap: 15px;">
                                    <span style="font-size: 24px; min-width: 40px;">${medal}</span>
                                    <span style="font-size: 18px; font-weight: bold;">${data.username}${isCurrentUser ? ' üëë' : ''}</span>
                                </div>
                                <span style="font-size: 24px; font-weight: bold; color: gold;">${data.score}</span>
                            </div>
                        `;
                    });
                    html += '</div>';
                    
                    highscoreList.innerHTML = html;
                }).catch((error) => {
                    console.error('‚ùå Fejl ved indl√¶sning af highscores:', error);
                    highscoreList.innerHTML = `
                        <div style="color: white; text-align: center; padding: 20px;">
                            <div style="font-size: 48px; margin-bottom: 10px;">‚ùå</div>
                            <div>Kunne ikke indl√¶se highscores</div>
                            <div style="font-size: 14px; opacity: 0.8; margin-top: 10px;">${error.message}</div>
                        </div>
                    `;
                });
            } catch (error) {
                console.error('‚ùå Firebase fejl:', error);
            }
        }
        
        // √Öbn highscore modal
        function openHighscores() {
            document.getElementById('highscoreModal').style.display = 'block';
            loadHighscores();
            
            // Vis brugerens bedste score
            const userHighScore = parseInt(localStorage.getItem('flappyHighScore')) || 0;
            document.getElementById('yourBestScore').textContent = userHighScore;
        }
        
        // Luk highscore modal
        function closeHighscores() {
            document.getElementById('highscoreModal').style.display = 'none';
        }
        
        // ========================================
        // SPIL VARIABLER
        // ========================================
        
        const bird = document.getElementById('bird');
        const gameContainer = document.getElementById('gameContainer');
        const scoreDisplay = document.getElementById('score');
        const gameOverScreen = document.getElementById('gameOver');
        const finalScoreDisplay = document.getElementById('finalScore');
        const startScreen = document.getElementById('startScreen');
        const skinSelector = document.getElementById('skinSelector');
        const coinsDisplay = document.getElementById('coins');
        const coinsEarnedDisplay = document.getElementById('coinsEarned');

        let gameWidth = window.innerWidth;
        let gameHeight = window.innerHeight;
        let birdY = gameHeight / 2;
        let birdVelocity = 0;
        let gravity = 0.6;
        let jumpStrength = -10;
        let gameRunning = false;
        let score = 0;
        let pipes = [];
        let pipeGap = Math.max(200, gameHeight * 0.25);
        let pipeWidth = 80;
        let pipeSpeed = 4;
        let frameCount = 0;
        let gameLoop;
        let currentLevel = 'medium';
        let coins = parseInt(localStorage.getItem('flappyCoins')) || 0;
        let currentSkin = localStorage.getItem('flappySkin') || 'classic';
        let unlockedSkins = JSON.parse(localStorage.getItem('flappySkins')) || ['classic'];
        let isAdmin = false;
        let godMode = false;

        let discoMode = false;
        let discoAudio = null;
        let discoLights = [];
        let currentUser = null;
        let users = JSON.parse(localStorage.getItem('flappyUsers')) || {};
        
        // R√∏r indstillinger
        let pipeColor = localStorage.getItem('flappyPipeColor') || '#8B4513'; // Brun som standard
        let movingPipesEnabled = true; // R√∏r bev√¶ger sig op/ned efter 5 r√∏r
        let speedIncreaseEnabled = false; // Hastighed stiger (sl√•et fra som standard)
        let basePipeSpeed = 4;
        let currentPipeSpeed = 4;
        let pipeMovementSpeed = 1; // Hvor hurtigt r√∏r bev√¶ger sig op/ned
        let pipeMovementRange = 100; // Hvor langt r√∏r kan bev√¶ge sig
        
        // Master admin kode (HEMMELIG - kun dig!)
        const MASTER_CODE = 'MALTHE_OWNER_2024';
        
        let isMasterAdmin = false;
        
        // Tjek om bruger er admin (fra session, ikke localStorage)
        if (sessionStorage.getItem('flappyAdminSession') === MASTER_CODE) {
            isAdmin = true;
            isMasterAdmin = true;
        }
        
        // Vis admin badge hvis master admin
        if (isMasterAdmin) {
            document.getElementById('adminBadge').style.display = 'block';
            document.getElementById('adminBadge').textContent = 'üëë OWNER';
        }
        
        // Skin definitioner
        const skins = {
            classic: { name: '√òrn (Klassisk)', color: '#8B4513', price: 0, emoji: 'ü¶Ö' },
            red: { name: 'R√∏d Fugl', color: '#ff4444', price: 50, emoji: 'üê¶' },
            blue: { name: 'Bl√• Fugl', color: '#4444ff', price: 50, emoji: 'üê¶' },
            green: { name: 'Gr√∏n Fugl', color: '#44ff44', price: 50, emoji: 'ü¶Ü' },
            pink: { name: 'Pink Fugl', color: '#ff44ff', price: 75, emoji: 'ü¶©' },
            rainbow: { name: 'Regnbue', color: 'linear-gradient(45deg, red, orange, yellow, green, blue, purple)', price: 100, emoji: 'üåà' },
            gold: { name: 'Guld', color: '#ffd700', price: 150, emoji: 'ü¶Ö' },
            diamond: { name: 'Diamant', color: 'linear-gradient(45deg, #b9f2ff, #ffffff, #b9f2ff)', price: 200, emoji: 'üíé' },
            fire: { name: 'Ild', color: 'linear-gradient(45deg, #ff0000, #ff6600, #ffaa00)', price: 250, emoji: 'üî•' },
            ghost: { name: 'Sp√∏gelse', color: 'rgba(255,255,255,0.7)', price: 300, emoji: 'üëª' }
        };
        
        // Level indstillinger
        const levelSettings = {
            easy: {
                gravity: 0.5,
                jumpStrength: -9,
                pipeSpeed: 2.5,
                pipeGapMultiplier: 0.35,
                pipeFrequency: 150  // √òget fra 110 - Mere afstand!
            },
            medium: {
                gravity: 0.6,
                jumpStrength: -10,
                pipeSpeed: 4,
                pipeGapMultiplier: 0.25,
                pipeFrequency: 120  // √òget fra 90 - Mere afstand!
            },
            hard: {
                gravity: 0.7,
                jumpStrength: -11,
                pipeSpeed: 5.5,
                pipeGapMultiplier: 0.20,
                pipeFrequency: 100  // √òget fra 75 - Mere afstand!
            }
        };

        // Opdater dimensioner ved resize
        window.addEventListener('resize', () => {
            gameWidth = window.innerWidth;
            gameHeight = window.innerHeight;
            pipeGap = Math.max(200, gameHeight * 0.25);
        });

        // Fyld profil liste
        function populateProfileList() {
            const profileSelect = document.getElementById('profileSelect');
            const allUsers = JSON.parse(localStorage.getItem('flappyUsers')) || {};
            const usernames = Object.keys(allUsers);
            
            // Ryd eksisterende options (bortset fra den f√∏rste)
            profileSelect.innerHTML = '<option value="">-- V√¶lg en profil --</option>';
            
            // Tilf√∏j alle brugere
            usernames.forEach(username => {
                const option = document.createElement('option');
                option.value = username;
                const userData = allUsers[username];
                const coins = userData.coins || 0;
                const highScore = userData.highScore || 0;
                option.textContent = `${username} (üí∞ ${coins} | üèÜ ${highScore})`;
                profileSelect.appendChild(option);
            });
            
            // Hvis der er profiler, vis antal
            if (usernames.length > 0) {
                const firstOption = profileSelect.options[0];
                firstOption.textContent = `-- V√¶lg profil (${usernames.length} profiler) --`;
            }
        }
        
        // N√•r profil v√¶lges fra dropdown
        function handleProfileSelect() {
            const profileSelect = document.getElementById('profileSelect');
            const loginUsername = document.getElementById('loginUsername');
            
            if (profileSelect.value) {
                loginUsername.value = profileSelect.value;
            }
        }
        
        // Tjek om bruger er logget ind
        const savedUser = localStorage.getItem('flappyCurrentUser');
        if (savedUser) {
            currentUser = savedUser;
            loadUserData();
            hideLoginScreen();
        } else {
            // Vis login screen og fyld profil liste
            document.getElementById('loginScreen').style.display = 'flex';
            populateProfileList();
        }
        
        // Login/Register funktioner
        
        function handleRegister(event) {
            event.preventDefault();
            
            // Reload users fra localStorage f√∏rst
            users = JSON.parse(localStorage.getItem('flappyUsers')) || {};
            
            const username = document.getElementById('registerUsername').value.trim();
            const password = document.getElementById('registerPassword').value;
            const passwordConfirm = document.getElementById('registerPasswordConfirm').value;
            const errorDiv = document.getElementById('registerError');
            const successDiv = document.getElementById('registerSuccess');
            
            errorDiv.textContent = '';
            successDiv.textContent = '';
            
            // Valider
            if (username.length < 3) {
                errorDiv.textContent = '‚ùå Brugernavn skal v√¶re mindst 3 tegn';
                return;
            }
            
            if (password.length < 4) {
                errorDiv.textContent = '‚ùå Kode skal v√¶re mindst 4 tegn';
                return;
            }
            
            if (password !== passwordConfirm) {
                errorDiv.textContent = '‚ùå Koderne matcher ikke!';
                return;
            }
            
            if (users[username]) {
                errorDiv.textContent = '‚ùå Brugernavn er allerede taget!';
                return;
            }
            
            // Opret bruger
            users[username] = {
                password: password,
                coins: 0,
                skins: ['classic'],
                currentSkin: 'classic',
                highScore: 0,
                createdAt: new Date().toISOString()
            };
            
            localStorage.setItem('flappyUsers', JSON.stringify(users));
            
            // Auto-login efter registrering
            currentUser = username;
            localStorage.setItem('flappyCurrentUser', username);
            loadUserData();
            hideLoginScreen();
            
            alert(`‚úÖ Velkommen ${username}! Din profil er oprettet! üéâ`);
            
            // Clear form
            document.getElementById('registerForm').reset();
            
            // Ikke n√∏dvendigt mere - vi logger direkte ind
            /*setTimeout(() => {
                showLoginTab('login');
                document.getElementById('loginUsername').value = username;
            }, 1500);*/
        }
        
        function handleLogin(event) {
            event.preventDefault();
            
            // Reload users fra localStorage F√òRST for at sikre vi har nyeste data
            users = JSON.parse(localStorage.getItem('flappyUsers')) || {};
            
            // Hent username fra enten dropdown eller tekstfelt
            const profileSelect = document.getElementById('profileSelect').value;
            const usernameInput = document.getElementById('loginUsername').value.trim();
            const username = profileSelect || usernameInput;
            const password = document.getElementById('loginPassword').value;
            const errorDiv = document.getElementById('loginError');
            
            errorDiv.textContent = '';
            
            // Tjek om username er udfyldt
            if (!username) {
                errorDiv.textContent = '‚ùå V√¶lg en profil eller indtast brugernavn!';
                return;
            }
            
            if (!users[username]) {
                errorDiv.textContent = '‚ùå Brugernavn findes ikke!';
                return;
            }
            
            if (users[username].password !== password) {
                errorDiv.textContent = '‚ùå Forkert kode!';
                return;
            }
            
            // Login success
            currentUser = username;
            localStorage.setItem('flappyCurrentUser', username);
            
            loadUserData();
            hideLoginScreen();
        }
        
        function loadUserData() {
            const userData = users[currentUser];
            
            // Tjek om userData findes
            if (!userData) {
                console.error('Bruger data ikke fundet for:', currentUser);
                alert('‚ùå Fejl: Profil data ikke fundet!');
                handleLogout(true); // skipSave = true
                return;
            }
            
            // Load user data
            coins = userData.coins || 0;
            unlockedSkins = userData.skins || ['classic'];
            currentSkin = userData.currentSkin || 'classic';
            
            // Update display
            coinsDisplay.textContent = coins;
            document.getElementById('profileDisplay').textContent = `üë§ ${currentUser}`;
            applySkin(currentSkin);
        }
        
        function saveUserData() {
            if (!currentUser) return;
            
            // Reload users og tjek om bruger findes
            users = JSON.parse(localStorage.getItem('flappyUsers')) || {};
            if (!users[currentUser]) {
                console.error('Kan ikke gemme data - bruger findes ikke:', currentUser);
                return;
            }
            
            users[currentUser].coins = coins;
            users[currentUser].skins = unlockedSkins;
            users[currentUser].currentSkin = currentSkin;
            users[currentUser].highScore = Math.max(users[currentUser].highScore || 0, score);
            
            localStorage.setItem('flappyUsers', JSON.stringify(users));
        }
        
        function hideLoginScreen() {
            document.getElementById('loginScreen').style.display = 'none';
            // Vis intro sk√¶rm i stedet for at starte direkte
            showIntroScreen();
        }
        
        function showIntroScreen() {
            // Opdater intro med bruger data
            document.getElementById('introUsername').textContent = currentUser;
            document.getElementById('introHighScore').textContent = users[currentUser]?.highScore || 0;
            document.getElementById('introCoins').textContent = coins;
            
            // Vis admin knap hvis bruger er admin
            if (isAdmin) {
                document.getElementById('introAdminButton').style.display = 'inline-block';
            }
            
            // Opret skyer
            createClouds();
            
            // Vis intro
            document.getElementById('introScreen').style.display = 'flex';
        }
        
        function startGameFromIntro() {
            // Skjul intro med fade out
            const intro = document.getElementById('introScreen');
            intro.style.animation = 'fadeOut 0.5s ease-out';
            setTimeout(() => {
                intro.style.display = 'none';
                intro.style.animation = 'fadeIn 0.5s ease-in';
                startGame('medium');
            }, 500);
        }
        
        function handleLogout(skipSave = false) {
            // Hvis skipSave er true, spring confirm over (bruges ved fejl)
            if (skipSave || confirm('üö™ Er du sikker p√• du vil logge ud?')) {
                if (!skipSave) {
                    saveUserData();
                }
                currentUser = null;
                localStorage.removeItem('flappyCurrentUser');
                location.reload();
            }
        }
        
        // Tilf√∏j skyer
        function createClouds() {
            for (let i = 0; i < 3; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                cloud.style.width = (Math.random() * 60 + 40) + 'px';
                cloud.style.height = (Math.random() * 30 + 20) + 'px';
                cloud.style.left = (Math.random() * 350) + 'px';
                cloud.style.top = (Math.random() * 200 + 50) + 'px';
                gameContainer.appendChild(cloud);
            }
        }

        createClouds();
        
        // Indl√¶s gemt r√∏r farve
        const savedPipeColor = localStorage.getItem('flappyPipeColor');
        if (savedPipeColor) {
            const colors = {
                'Brun (Standard)': { main: '#8B4513', light: '#A0522D', dark: '#654321' },
                'Gr√∏n': { main: '#228B22', light: '#32CD32', dark: '#006400' },
                'R√∏d': { main: '#DC143C', light: '#FF6347', dark: '#8B0000' },
                'Bl√•': { main: '#1E90FF', light: '#4169E1', dark: '#00008B' },
                'Lilla': { main: '#8B008B', light: '#9370DB', dark: '#4B0082' },
                'Orange': { main: '#FF8C00', light: '#FFA500', dark: '#FF4500' },
                'Gul': { main: '#FFD700', light: '#FFFF00', dark: '#DAA520' },
                'Pink': { main: '#FF1493', light: '#FF69B4', dark: '#C71585' },
                'Turkis': { main: '#00CED1', light: '#40E0D0', dark: '#008B8B' },
                'Gr√•': { main: '#696969', light: '#808080', dark: '#2F4F4F' }
            };
            
            const color = colors[savedPipeColor];
            if (color) {
                const style = document.createElement('style');
                style.id = 'pipeColorStyle';
                style.textContent = `
                    .pipe {
                        background: linear-gradient(90deg, ${color.main} 0%, ${color.light} 50%, ${color.main} 100%) !important;
                        border-color: ${color.dark} !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }
        
        // Event listeners for login/register (efter DOM er loaded)
        document.getElementById('loginForm').addEventListener('submit', handleLogin);
        document.getElementById('registerForm').addEventListener('submit', handleRegister);
        document.getElementById('profileSelect').addEventListener('change', handleProfileSelect);
        
        // Initialiser skin selector
        function initSkinSelector() {
            const skinsGrid = document.getElementById('skinsGrid');
            skinsGrid.innerHTML = '';
            
            Object.keys(skins).forEach(skinId => {
                const skin = skins[skinId];
                const isUnlocked = unlockedSkins.includes(skinId);
                const isSelected = currentSkin === skinId;
                
                const card = document.createElement('div');
                card.className = `skin-card ${isSelected ? 'selected' : ''} ${!isUnlocked ? 'locked' : ''}`;
                
                const preview = document.createElement('div');
                preview.className = 'skin-preview';
                preview.style.background = skin.color;
                
                const name = document.createElement('h3');
                name.textContent = skin.name;
                
                const priceTag = document.createElement('div');
                if (isUnlocked) {
                    priceTag.className = 'unlocked';
                    priceTag.textContent = isSelected ? '‚úîÔ∏è Valgt' : '‚úÖ L√•st op';
                } else {
                    priceTag.className = 'price';
                    priceTag.innerHTML = `ü™ô ${skin.price}`;
                }
                
                if (!isUnlocked) {
                    const lock = document.createElement('div');
                    lock.className = 'lock-icon';
                    lock.textContent = 'üîí';
                    card.appendChild(lock);
                }
                
                card.appendChild(preview);
                card.appendChild(name);
                card.appendChild(priceTag);
                
                card.onclick = () => selectSkin(skinId);
                
                skinsGrid.appendChild(card);
            });
        }
        
        function openSkinSelector() {
            // Skjul intro sk√¶rm
            document.getElementById('introScreen').style.display = 'none';
            initSkinSelector();
            skinSelector.style.display = 'block';
        }
        
        function closeSkinSelector() {
            skinSelector.style.display = 'none';
            // Vis intro sk√¶rm igen
            document.getElementById('introScreen').style.display = 'flex';
        }
        
        function selectSkin(skinId) {
            const skin = skins[skinId];
            const isUnlocked = unlockedSkins.includes(skinId);
            
            if (!isUnlocked) {
                // Pr√∏v at k√∏be
                if (coins >= skin.price) {
                    coins -= skin.price;
                    unlockedSkins.push(skinId);
                    localStorage.setItem('flappyCoins', coins);
                    localStorage.setItem('flappySkins', JSON.stringify(unlockedSkins));
                    coinsDisplay.textContent = coins;
                } else {
                    alert(`Du mangler ${skin.price - coins} coins! ü™ô`);
                    return;
                }
            }
            
            currentSkin = skinId;
            localStorage.setItem('flappySkin', skinId);
            applySkin(skinId);
            saveUserData();
            initSkinSelector();
        }
        
        function applySkin(skinId) {
            const skin = skins[skinId];
            // Behold √∏rne gradient som base, men tilf√∏j skin farve som overlay
            if (skinId === 'classic') {
                bird.style.background = 'linear-gradient(135deg, #8B4513 0%, #654321 50%, #3E2723 100%)';
            } else {
                // Bland skin farven med √∏rne farver
                bird.style.background = `linear-gradient(135deg, ${skin.color} 0%, #654321 50%, #3E2723 100%)`;
            }
        }
        
        // Admin funktioner
        function checkAdminCode() {
            const code = prompt('üîê Indtast Admin Kode:');
            if (!code) return;
            
            // Tjek Master Owner kode
            if (code === MASTER_CODE) {
                isAdmin = true;
                isMasterAdmin = true;
                sessionStorage.setItem('flappyAdminSession', MASTER_CODE);
                document.getElementById('adminBadge').style.display = 'block';
                document.getElementById('adminBadge').textContent = 'üëë OWNER';
                alert('‚úÖ MASTER OWNER aktiveret! Du har fuld kontrol.');
                return;
            }
            
            // Tjek engangskoder
            let adminCodes = JSON.parse(localStorage.getItem('flappyAdminCodes')) || [];
            const codeIndex = adminCodes.findIndex(c => c.code === code && !c.used);
            
            if (codeIndex !== -1) {
                // Marker kode som brugt
                adminCodes[codeIndex].used = true;
                adminCodes[codeIndex].usedBy = currentUser;
                adminCodes[codeIndex].usedAt = new Date().toISOString();
                localStorage.setItem('flappyAdminCodes', JSON.stringify(adminCodes));
                
                // Giv admin rettigheder (men ikke master)
                isAdmin = true;
                isMasterAdmin = false;
                sessionStorage.setItem('flappyAdminSession', code);
                document.getElementById('adminBadge').style.display = 'block';
                document.getElementById('adminBadge').textContent = 'üîë ADMIN';
                alert('‚úÖ ADMIN aktiveret!\n\n‚ö†Ô∏è Du har begr√¶nset admin adgang.\nKun OWNER kan give m√∏nter og generere koder.');
                return;
            }
            
            // Tjek om koden er brugt
            const usedCode = adminCodes.find(c => c.code === code && c.used);
            if (usedCode) {
                alert(`‚ùå Denne kode er allerede brugt!\n\nBrugt af: ${usedCode.usedBy}\nBrugt: ${new Date(usedCode.usedAt).toLocaleString('da-DK')}`);
                return;
            }
            
            // Forkert kode
            alert('‚ùå Forkert kode!');
        }
        
        function openAdminPanel() {
            if (!isAdmin) {
                checkAdminCode();
                if (!isAdmin) return;
            }
            // Skjul intro sk√¶rm
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
        }
        
        function closeAdminPanel() {
            document.getElementById('adminPanel').style.display = 'none';
            // Vis intro sk√¶rm igen
            document.getElementById('introScreen').style.display = 'flex';
        }
        
        function openSettings() {
            // Skjul intro sk√¶rm
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('settingsMenu').style.display = 'block';
            // Opdater checkboxes
            document.getElementById('movingPipesToggle').checked = movingPipesEnabled;
            document.getElementById('speedIncreaseToggle').checked = speedIncreaseEnabled;
        }
        
        function closeSettings() {
            document.getElementById('settingsMenu').style.display = 'none';
            // Vis intro sk√¶rm igen
            document.getElementById('introScreen').style.display = 'flex';
        }
        
        function changePipeColor(color) {
            pipeColor = color;
            localStorage.setItem('flappyPipeColor', color);
            applyPipeColor();
            showMessage('üé® R√∏r farve √¶ndret!', 1500);
        }
        
        function applyPipeColor() {
            // Beregn lysere og m√∏rkere nuancer
            const hex = pipeColor.replace('#', '');
            const r = parseInt(hex.substr(0, 2), 16);
            const g = parseInt(hex.substr(2, 2), 16);
            const b = parseInt(hex.substr(4, 2), 16);
            
            const lighter = `rgb(${Math.min(r + 40, 255)}, ${Math.min(g + 40, 255)}, ${Math.min(b + 40, 255)})`;
            const darker = `rgb(${Math.max(r - 40, 0)}, ${Math.max(g - 40, 0)}, ${Math.max(b - 40, 0)})`;
            
            // Opdater alle eksisterende r√∏r
            const allPipes = document.querySelectorAll('.pipe');
            allPipes.forEach(pipe => {
                pipe.style.background = `linear-gradient(90deg, ${pipeColor} 0%, ${lighter} 50%, ${pipeColor} 100%)`;
                pipe.style.borderColor = darker;
            });
            
            // Tilf√∏j style tag for fremtidige r√∏r
            let style = document.getElementById('pipeColorStyle');
            if (!style) {
                style = document.createElement('style');
                style.id = 'pipeColorStyle';
                document.head.appendChild(style);
            }
            style.textContent = `
                .pipe {
                    background: linear-gradient(90deg, ${pipeColor} 0%, ${lighter} 50%, ${pipeColor} 100%) !important;
                    border-color: ${darker} !important;
                }
            `;
        }
        
        function toggleMovingPipes() {
            movingPipesEnabled = !movingPipesEnabled;
            showMessage(movingPipesEnabled ? '‚ö° Bev√¶gelige r√∏r aktiveret!' : '‚ö° Bev√¶gelige r√∏r deaktiveret!', 1500);
        }
        
        function toggleSpeedIncrease() {
            speedIncreaseEnabled = !speedIncreaseEnabled;
            showMessage(speedIncreaseEnabled ? 'üöÄ Stigende hastighed aktiveret!' : 'üöÄ Stigende hastighed deaktiveret!', 1500);
        }
        
        function showMessage(text, duration = 2000) {
            const messageDiv = document.createElement('div');
            messageDiv.textContent = text;
            messageDiv.style.cssText = `
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                background: rgba(0,0,0,0.9);
                color: white;
                padding: 20px 40px;
                border-radius: 15px;
                font-size: 24px;
                font-weight: bold;
                z-index: 100;
                box-shadow: 0 10px 30px rgba(0,0,0,0.5);
                animation: fadeInOut ${duration}ms ease-in-out;
            `;
            document.body.appendChild(messageDiv);
            setTimeout(() => messageDiv.remove(), duration);
        }
        
        function openCustomSettings() {
            // Skjul intro sk√¶rm
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('customSettings').style.display = 'block';
            
            // Load gemte v√¶rdier eller brug defaults
            const customSettings = JSON.parse(localStorage.getItem('flappyCustomSettings')) || {
                pipeFrequency: 90,
                pipeGap: 250,
                pipeSpeed: 4,
                gravity: 0.6,
                jumpStrength: -10
            };
            
            // Opdater sliders
            document.getElementById('pipeFrequencySlider').value = customSettings.pipeFrequency;
            document.getElementById('pipeGapSlider').value = customSettings.pipeGap;
            document.getElementById('pipeSpeedSlider').value = customSettings.pipeSpeed;
            document.getElementById('gravitySlider').value = customSettings.gravity;
            document.getElementById('jumpStrengthSlider').value = customSettings.jumpStrength;
            
            // Opdater displays
            updateSliderDisplays();
            
            // Tilf√∏j event listeners til sliders
            document.getElementById('pipeFrequencySlider').oninput = updateSliderDisplays;
            document.getElementById('pipeGapSlider').oninput = updateSliderDisplays;
            document.getElementById('pipeSpeedSlider').oninput = updateSliderDisplays;
            document.getElementById('gravitySlider').oninput = updateSliderDisplays;
            document.getElementById('jumpStrengthSlider').oninput = updateSliderDisplays;
        }
        
        function closeCustomSettings() {
            document.getElementById('customSettings').style.display = 'none';
            // Vis intro sk√¶rm igen
            document.getElementById('introScreen').style.display = 'flex';
        }
        
        function updateSliderDisplays() {
            document.getElementById('pipeFrequencyValue').textContent = document.getElementById('pipeFrequencySlider').value;
            document.getElementById('pipeGapValue').textContent = document.getElementById('pipeGapSlider').value;
            document.getElementById('pipeSpeedValue').textContent = document.getElementById('pipeSpeedSlider').value;
            document.getElementById('gravityValue').textContent = document.getElementById('gravitySlider').value;
            document.getElementById('jumpStrengthValue').textContent = document.getElementById('jumpStrengthSlider').value;
        }
        
        function startCustomGame() {
            // Hent v√¶rdier fra sliders
            const customSettings = {
                pipeFrequency: parseInt(document.getElementById('pipeFrequencySlider').value),
                pipeGap: parseInt(document.getElementById('pipeGapSlider').value),
                pipeSpeed: parseFloat(document.getElementById('pipeSpeedSlider').value),
                gravity: parseFloat(document.getElementById('gravitySlider').value),
                jumpStrength: parseFloat(document.getElementById('jumpStrengthSlider').value)
            };
            
            // Gem indstillinger
            localStorage.setItem('flappyCustomSettings', JSON.stringify(customSettings));
            
            // Anvend indstillinger
            gravity = customSettings.gravity;
            jumpStrength = customSettings.jumpStrength;
            basePipeSpeed = customSettings.pipeSpeed;
            currentPipeSpeed = basePipeSpeed;
            pipeSpeed = basePipeSpeed;
            pipeGap = customSettings.pipeGap;
            
            // Opdater level settings for custom
            levelSettings.custom = {
                gravity: customSettings.gravity,
                jumpStrength: customSettings.jumpStrength,
                pipeSpeed: customSettings.pipeSpeed,
                pipeGapMultiplier: customSettings.pipeGap / gameHeight,
                pipeFrequency: customSettings.pipeFrequency
            };
            
            // Luk menu og start spil
            closeCustomSettings();
            currentLevel = 'custom';
            
            // Anvend r√∏r farve
            applyPipeColor();
            
            startScreen.style.display = 'none';
            gameRunning = true;
            birdY = gameHeight / 2;
            birdVelocity = 0;
            score = 0;
            pipes = [];
            frameCount = 0;
            scoreDisplay.textContent = score;
            gameOverScreen.style.display = 'none';
            gameLoop = setInterval(update, 1000 / 60);
            
            showMessage('‚öôÔ∏è Custom spil startet!', 2000);
        }
        
        function adminGiveCoinsToPlayer() {
            if (!isMasterAdmin) {
                alert('‚ùå Kun OWNER kan give m√∏nter til andre!');
                return;
            }
            
            // Hent alle brugere
            const allUsers = JSON.parse(localStorage.getItem('flappyUsers')) || {};
            const userList = Object.keys(allUsers);
            
            if (userList.length === 0) {
                alert('‚ùå Ingen spillere fundet!');
                return;
            }
            
            // Vis liste over spillere
            let userListText = 'üë• Tilg√¶ngelige spillere:\n\n';
            userList.forEach((user, index) => {
                const userData = allUsers[user];
                const currentCoins = userData.coins || 0;
                userListText += `${index + 1}. ${user} (${currentCoins} m√∏nter)\n`;
            });
            
            // Sp√∏rg om brugernavn
            const targetUser = prompt(userListText + '\nüë§ Indtast brugernavn:');
            if (!targetUser) return;
            
            // Tjek om bruger findes
            if (!allUsers[targetUser]) {
                alert(`‚ùå Bruger "${targetUser}" findes ikke!`);
                return;
            }
            
            // Sp√∏rg om antal m√∏nter
            const amount = prompt(`üí∞ Hvor mange m√∏nter vil du give til ${targetUser}?`, '100');
            if (!amount || isNaN(amount) || parseInt(amount) <= 0) {
                alert('‚ùå Ugyldigt antal!');
                return;
            }
            
            // Giv m√∏nter
            const coinsToGive = parseInt(amount);
            allUsers[targetUser].coins = (allUsers[targetUser].coins || 0) + coinsToGive;
            
            // Gem √¶ndringer
            localStorage.setItem('flappyUsers', JSON.stringify(allUsers));
            
            // Hvis det er den nuv√¶rende bruger, opdater ogs√• coins display
            if (targetUser === currentUser) {
                coins = allUsers[targetUser].coins;
                coinsDisplay.textContent = coins;
            }
            
            alert(`‚úÖ Gav ${coinsToGive} m√∏nter til ${targetUser}!\n\n${targetUser} har nu ${allUsers[targetUser].coins} m√∏nter!`);
        }
        
        function adminUnlockAll() {
            unlockedSkins = Object.keys(skins);
            localStorage.setItem('flappySkins', JSON.stringify(unlockedSkins));
            saveUserData();
            alert('‚úÖ Alle skins er l√•st op!');
            initSkinSelector();
        }
        
        function adminGodMode() {
            if (!isMasterAdmin) {
                alert('‚ùå Kun Master Owner kan aktivere god mode!');
                return;
            }
            godMode = !godMode;
            if (godMode) {
                alert('‚ú® Gud Mode aktiveret! Du kan ikke d√∏!');
            } else {
                alert('‚ùå Gud Mode deaktiveret.');
            }
        }
        
        function adminResetProgress() {
            if (confirm('‚ö†Ô∏è Er du sikker? Dette sletter ALT!')) {
                localStorage.removeItem('flappyCoins');
                localStorage.removeItem('flappySkins');
                localStorage.removeItem('flappySkin');
                alert('‚úÖ Alt er nulstillet!');
                location.reload();
            }
        }
        
        function adminGenerateCode() {
            if (!isMasterAdmin) {
                alert('‚ùå Kun OWNER kan generere admin koder!');
                return;
            }
            
            // Generer en unik engangskode
            const timestamp = Date.now();
            const random = Math.random().toString(36).substring(2, 15);
            const code = `ADMIN_${random}_${timestamp}`.toUpperCase();
            
            // Gem koden som ubrugt
            let adminCodes = JSON.parse(localStorage.getItem('flappyAdminCodes')) || [];
            adminCodes.push({
                code: code,
                used: false,
                createdAt: new Date().toISOString(),
                createdBy: currentUser
            });
            localStorage.setItem('flappyAdminCodes', JSON.stringify(adminCodes));
            
            // Vis koden
            document.getElementById('generatedCode').textContent = `üé´ Kode: ${code}`;
            
            // Kopier til clipboard
            navigator.clipboard.writeText(code).then(() => {
                alert(`‚úÖ ENGANGSKODE GENERERET!\n\nüé´ Kode: ${code}\n\nüìã Kopieret til clipboard!\n\n‚ö†Ô∏è Denne kode kan kun bruges √âN gang!\n\nGiv den til en person du vil give admin rettigheder.`);
            }).catch(() => {
                alert(`‚úÖ ENGANGSKODE GENERERET!\n\nüé´ Kode: ${code}\n\n‚ö†Ô∏è Denne kode kan kun bruges √âN gang!\n\nGiv den til en person du vil give admin rettigheder.`);
            });
        }
        
        // Admin besked funktion
        function adminSendMessage() {
            const message = prompt('üì¢ Skriv din besked til alle spillere:');
            if (message) {
                showAdminMessage(message);
            }
        }
        
        // Del spil funktion
        function adminShareGame() {
            const gameUrl = window.location.href;
            
            // Kopier til clipboard
            navigator.clipboard.writeText(gameUrl).then(() => {
                // Vis share dialog
                const shareText = `üéÆ Flappy Eagle Spil Link:\n\n${gameUrl}\n\n‚úÖ Link kopieret!\n\nDu kan nu:\n1. Inds√¶tte linket i en email\n2. Sende det p√• Discord/Messenger\n3. Dele det hvor du vil!`;
                
                alert(shareText);
                
                // Pr√∏v at √•bne email klient (valgfrit)
                const wantEmail = confirm('üìß Vil du √•bne din email for at sende linket?');
                if (wantEmail) {
                    const subject = encodeURIComponent('üéÆ Kom og spil Flappy Eagle!');
                    const body = encodeURIComponent(`Hej!\n\nKom og spil mit Flappy Eagle spil:\n${gameUrl}\n\nHav det sjovt! ü¶Ö‚ú®`);
                    window.open(`mailto:?subject=${subject}&body=${body}`);
                }
            }).catch(() => {
                // Hvis clipboard fejler, vis bare linket
                alert(`üîó Spil Link:\n\n${gameUrl}\n\nKopier dette link og send det til dine venner!`);
            });
        }
        
        function showAdminMessage(message) {
            const messageDiv = document.getElementById('adminMessage');
            
            // Vis OWNER eller ADMIN baseret p√• hvem der sender
            const prefix = isMasterAdmin ? 'üëë OWNER: ' : 'üîë ADMIN: ';
            messageDiv.textContent = prefix + message;
            messageDiv.style.display = 'block';
            
            // Skjul efter 5 sekunder
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }
        
        // R√∏r farve funktion
        function adminChangePipeColor() {
            const colors = {
                'Brun (Standard)': { main: '#8B4513', light: '#A0522D', dark: '#654321' },
                'Gr√∏n': { main: '#228B22', light: '#32CD32', dark: '#006400' },
                'R√∏d': { main: '#DC143C', light: '#FF6347', dark: '#8B0000' },
                'Bl√•': { main: '#1E90FF', light: '#4169E1', dark: '#00008B' },
                'Lilla': { main: '#8B008B', light: '#9370DB', dark: '#4B0082' },
                'Orange': { main: '#FF8C00', light: '#FFA500', dark: '#FF4500' },
                'Gul': { main: '#FFD700', light: '#FFFF00', dark: '#DAA520' },
                'Pink': { main: '#FF1493', light: '#FF69B4', dark: '#C71585' },
                'Turkis': { main: '#00CED1', light: '#40E0D0', dark: '#008B8B' },
                'Gr√•': { main: '#696969', light: '#808080', dark: '#2F4F4F' }
            };
            
            let colorList = 'V√¶lg r√∏rets farve:\n\n';
            Object.keys(colors).forEach((name, index) => {
                colorList += `${index + 1}. ${name}\n`;
            });
            
            const choice = prompt(colorList);
            if (!choice) return;
            
            const colorNames = Object.keys(colors);
            const selectedName = colorNames.find(name => 
                name.toLowerCase().includes(choice.toLowerCase()) || 
                choice === (colorNames.indexOf(name) + 1).toString()
            );
            
            if (!selectedName) {
                alert('‚ùå Ugyldig farve!');
                return;
            }
            
            const color = colors[selectedName];
            
            // Opdater CSS for alle r√∏r
            const style = document.createElement('style');
            style.id = 'pipeColorStyle';
            style.textContent = `
                .pipe {
                    background: linear-gradient(90deg, ${color.main} 0%, ${color.light} 50%, ${color.main} 100%) !important;
                    border-color: ${color.dark} !important;
                }
            `;
            
            // Fjern gammel style hvis den findes
            const oldStyle = document.getElementById('pipeColorStyle');
            if (oldStyle) oldStyle.remove();
            
            document.head.appendChild(style);
            
            // Gem farve valg
            localStorage.setItem('flappyPipeColor', selectedName);
            
            alert(`‚úÖ R√∏rene er nu ${selectedName}! üé®`);
        }
        
        // Vejr-effekt variabler
        let currentWeather = 'day';
        let weatherParticles = [];
        let lightningInterval = null;
        let weatherAudio = null;
        let audioContext = null;
        let audioSource = null;
        let gainNode = null;
        
        function setWeather(weather) {
            if (!isMasterAdmin) {
                alert('‚ùå Kun OWNER kan √¶ndre vejret!');
                return;
            }
            
            // Fjern gammelt vejr
            clearWeather();
            
            currentWeather = weather;
            gameContainer.className = weather === 'clear' ? '' : weather;
            
            // Start nyt vejr
            switch(weather) {
                case 'day':
                    gameContainer.style.background = '';
                    playWeatherSound('birds');
                    alert('‚òÄÔ∏è Dag aktiveret! üê¶');
                    break;
                case 'night':
                    gameContainer.style.background = '';
                    createStars();
                    playWeatherSound('night');
                    alert('üåô Nat aktiveret! ü¶â');
                    break;
                case 'rain':
                    gameContainer.style.background = '';
                    createRain();
                    playWeatherSound('rain');
                    alert('üåßÔ∏è Regn aktiveret! üíß');
                    break;
                case 'storm':
                    gameContainer.style.background = '';
                    createRain();
                    createLightning();
                    playWeatherSound('storm');
                    alert('‚õàÔ∏è Torden aktiveret! ‚ö°');
                    break;
                case 'snow':
                    gameContainer.style.background = '';
                    createSnow();
                    playWeatherSound('snow');
                    alert('‚ùÑÔ∏è Sne aktiveret! ‚õÑ');
                    break;
                case 'clear':
                    gameContainer.style.background = '';
                    alert('üîÑ Normalt vejr!');
                    break;
            }
        }
        
        function clearWeather() {
            // Fjern alle vejr partikler
            weatherParticles.forEach(p => p.remove());
            weatherParticles = [];
            
            // Stop lyn
            if (lightningInterval) {
                clearInterval(lightningInterval);
                lightningInterval = null;
            }
            
            // Fjern lyn element
            const lightning = document.querySelector('.lightning');
            if (lightning) lightning.remove();
            
            // Stop lyd
            stopWeatherSound();
        }
        
        function createStars() {
            for (let i = 0; i < 100; i++) {
                const star = document.createElement('div');
                star.className = 'weather-particle';
                star.textContent = '‚≠ê';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 80 + '%';
                star.style.fontSize = (Math.random() * 10 + 5) + 'px';
                star.style.opacity = Math.random() * 0.8 + 0.2;
                star.style.animation = `blink ${Math.random() * 3 + 2}s ease-in-out infinite`;
                gameContainer.appendChild(star);
                weatherParticles.push(star);
            }
        }
        
        function createRain() {
            for (let i = 0; i < 50; i++) {
                const drop = document.createElement('div');
                drop.className = 'weather-particle raindrop';
                drop.style.left = Math.random() * 100 + '%';
                drop.style.top = -20 + 'px';
                drop.style.animationDuration = (Math.random() * 0.5 + 0.5) + 's';
                drop.style.animationDelay = Math.random() * 2 + 's';
                gameContainer.appendChild(drop);
                weatherParticles.push(drop);
            }
        }
        
        function createSnow() {
            for (let i = 0; i < 30; i++) {
                const flake = document.createElement('div');
                flake.className = 'weather-particle snowflake';
                flake.textContent = '‚ùÑÔ∏è';
                flake.style.left = Math.random() * 100 + '%';
                flake.style.top = -20 + 'px';
                flake.style.animationDuration = (Math.random() * 3 + 3) + 's';
                flake.style.animationDelay = Math.random() * 3 + 's';
                gameContainer.appendChild(flake);
                weatherParticles.push(flake);
            }
        }
        
        function createClouds() {
            // Fjern gamle skyer
            document.querySelectorAll('.cloud').forEach(cloud => cloud.remove());
            
            // Opret 8-12 skyer
            const numClouds = Math.floor(Math.random() * 5) + 8;
            
            for (let i = 0; i < numClouds; i++) {
                const cloud = document.createElement('div');
                cloud.className = 'cloud';
                
                // Tilf√¶ldig st√∏rrelse
                const width = Math.random() * 80 + 60; // 60-140px
                const height = width * 0.6; // H√∏jde er 60% af bredde
                
                cloud.style.width = width + 'px';
                cloud.style.height = height + 'px';
                
                // Tilf√¶ldig position
                cloud.style.left = Math.random() * 100 + '%';
                cloud.style.top = Math.random() * 40 + '%'; // √òverste 40% af sk√¶rmen
                
                // Tilf√¶ldig hastighed (20-60 sekunder)
                const duration = Math.random() * 40 + 20;
                cloud.style.animationDuration = duration + 's';
                
                // Tilf√¶ldig delay
                cloud.style.animationDelay = Math.random() * 10 + 's';
                
                gameContainer.appendChild(cloud);
            }
        }
        
        function createLightning() {
            const lightning = document.createElement('div');
            lightning.className = 'lightning';
            gameContainer.appendChild(lightning);
            
            lightningInterval = setInterval(() => {
                if (Math.random() < 0.3) { // 30% chance hver sekund
                    lightning.style.opacity = '1';
                    playThunderSound(); // Afspil torden lyd
                    setTimeout(() => {
                        lightning.style.opacity = '0';
                    }, 100);
                }
            }, 1000);
        }
        
        // Lyd-funktioner til vejr
        function playWeatherSound(type) {
            stopWeatherSound();
            
            // Opret AudioContext
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            switch(type) {
                case 'birds':
                    playBirdSound();
                    break;
                case 'night':
                    playNightSound();
                    break;
                case 'rain':
                    playRainSound();
                    break;
                case 'storm':
                    playRainSound();
                    // Torden lyd afspilles automatisk ved lyn
                    break;
                case 'snow':
                    playWindSound();
                    break;
            }
        }
        
        function stopWeatherSound() {
            if (audioSource) {
                try {
                    audioSource.stop();
                } catch(e) {}
                audioSource = null;
            }
        }
        
        function playBirdSound() {
            // Fugle kvidren (h√∏j frekvens chirps)
            const interval = setInterval(() => {
                if (currentWeather !== 'day') {
                    clearInterval(interval);
                    return;
                }
                
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.frequency.value = 2000 + Math.random() * 1000;
                osc.type = 'sine';
                
                gain.gain.setValueAtTime(0.1, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                
                osc.connect(gain);
                gain.connect(audioContext.destination);
                
                osc.start();
                osc.stop(audioContext.currentTime + 0.2);
            }, 2000 + Math.random() * 3000);
        }
        
        function playNightSound() {
            // Nat lyde (ugler og crickets)
            const interval = setInterval(() => {
                if (currentWeather !== 'night') {
                    clearInterval(interval);
                    return;
                }
                
                // Cricket lyd
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.frequency.value = 4000 + Math.random() * 500;
                osc.type = 'square';
                
                gain.gain.setValueAtTime(0.05, audioContext.currentTime);
                gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                osc.connect(gain);
                gain.connect(audioContext.destination);
                
                osc.start();
                osc.stop(audioContext.currentTime + 0.1);
            }, 500 + Math.random() * 1000);
        }
        
        function playRainSound() {
            // Regn lyd (hvid st√∏j)
            const bufferSize = audioContext.sampleRate * 2;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                data[i] = Math.random() * 2 - 1;
            }
            
            audioSource = audioContext.createBufferSource();
            audioSource.buffer = buffer;
            audioSource.loop = true;
            
            gainNode = audioContext.createGain();
            gainNode.gain.value = 0.15;
            
            // Tilf√∏j lavpas filter for regn effekt
            const filter = audioContext.createBiquadFilter();
            filter.type = 'lowpass';
            filter.frequency.value = 1000;
            
            audioSource.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            audioSource.start();
        }
        
        function playWindSound() {
            // Vind lyd (lav frekvens hvid st√∏j)
            const bufferSize = audioContext.sampleRate * 2;
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                data[i] = Math.random() * 2 - 1;
            }
            
            audioSource = audioContext.createBufferSource();
            audioSource.buffer = buffer;
            audioSource.loop = true;
            
            gainNode = audioContext.createGain();
            gainNode.gain.value = 0.1;
            
            // Lavpas filter for vind effekt
            const filter = audioContext.createBiquadFilter();
            filter.type = 'lowpass';
            filter.frequency.value = 500;
            
            audioSource.connect(filter);
            filter.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            audioSource.start();
        }
        
        function playThunderSound() {
            // Torden lyd (dyb rumble)
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            
            osc.frequency.setValueAtTime(50, audioContext.currentTime);
            osc.frequency.exponentialRampToValueAtTime(30, audioContext.currentTime + 0.5);
            osc.type = 'sawtooth';
            
            gain.gain.setValueAtTime(0.3, audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.5);
            
            osc.connect(gain);
            gain.connect(audioContext.destination);
            
            osc.start();
            osc.stop(audioContext.currentTime + 1.5);
        }
        
        // Disko mode funktioner
        function adminToggleDisco() {
            if (!isMasterAdmin) {
                alert('‚ùå Kun Master Owner kan aktivere disko mode!');
                return;
            }
            discoMode = !discoMode;
            
            if (discoMode) {
                startDiscoMode();
                alert('ü•≥ DISKO MODE AKTIVERET! LET\'S PARTY! üéâ');
            } else {
                stopDiscoMode();
                alert('‚ùå Disko mode deaktiveret.');
            }
        }
        
        function startDiscoMode() {
            // Tilf√∏j disko baggrund
            gameContainer.classList.add('disco-mode');
            bird.classList.add('disco-bird');
            
            // Opret disko lys
            for (let i = 0; i < 10; i++) {
                const light = document.createElement('div');
                light.className = 'disco-lights';
                light.style.left = Math.random() * 100 + '%';
                light.style.top = Math.random() * 100 + '%';
                light.style.background = getRandomColor();
                light.style.animationDelay = Math.random() * 2 + 's';
                gameContainer.appendChild(light);
                discoLights.push(light);
            }
            
            // Opret disko musik (syntetisk beat)
            createDiscoMusic();
        }
        
        function stopDiscoMode() {
            gameContainer.classList.remove('disco-mode');
            bird.classList.remove('disco-bird');
            
            // Fjern disko lys
            discoLights.forEach(light => light.remove());
            discoLights = [];
            
            // Stop musik
            if (discoAudio) {
                discoAudio.stop();
                discoAudio = null;
            }
        }
        
        function getRandomColor() {
            const colors = ['#ff0000', '#ff7700', '#ffff00', '#00ff00', '#0077ff', '#0000ff', '#ff00ff'];
            return colors[Math.floor(Math.random() * colors.length)];
        }
        
        function createDiscoMusic() {
            // Web Audio API til at lave disko beat
            const AudioContext = window.AudioContext || window.webkitAudioContext;
            const audioContext = new AudioContext();
            
            let isPlaying = true;
            let beatCount = 0;
            
            // Disko melodi noter (C, D, E, G, A)
            const notes = [261.63, 293.66, 329.63, 392.00, 440.00];
            
            function playBeat() {
                if (!discoMode || !isPlaying) return;
                
                const now = audioContext.currentTime;
                
                // Kraftig bass drum (kick)
                const bass = audioContext.createOscillator();
                const bassGain = audioContext.createGain();
                bass.connect(bassGain);
                bassGain.connect(audioContext.destination);
                bass.frequency.value = 60;
                bassGain.gain.value = 0.5;
                bass.start(now);
                bassGain.gain.exponentialRampToValueAtTime(0.01, now + 0.15);
                bass.stop(now + 0.15);
                
                // Hi-hat p√• off-beat
                setTimeout(() => {
                    if (!discoMode) return;
                    const hihat = audioContext.createOscillator();
                    const hihatGain = audioContext.createGain();
                    hihat.connect(hihatGain);
                    hihatGain.connect(audioContext.destination);
                    hihat.frequency.value = 10000;
                    hihat.type = 'square';
                    hihatGain.gain.value = 0.03;
                    hihat.start();
                    hihatGain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.03);
                    hihat.stop(audioContext.currentTime + 0.03);
                }, 250);
                
                // Synth melodi hver 4. beat
                if (beatCount % 4 === 0) {
                    const noteIndex = Math.floor(beatCount / 4) % notes.length;
                    const synth = audioContext.createOscillator();
                    const synthGain = audioContext.createGain();
                    synth.connect(synthGain);
                    synthGain.connect(audioContext.destination);
                    synth.frequency.value = notes[noteIndex];
                    synth.type = 'sawtooth';
                    synthGain.gain.value = 0.15;
                    synth.start(now + 0.1);
                    synthGain.gain.exponentialRampToValueAtTime(0.01, now + 0.4);
                    synth.stop(now + 0.4);
                }
                
                // Snare drum hver 4. beat (offset 2)
                if (beatCount % 4 === 2) {
                    const snare = audioContext.createOscillator();
                    const snareGain = audioContext.createGain();
                    snare.connect(snareGain);
                    snareGain.connect(audioContext.destination);
                    snare.frequency.value = 200;
                    snare.type = 'triangle';
                    snareGain.gain.value = 0.2;
                    snare.start(now);
                    snareGain.gain.exponentialRampToValueAtTime(0.01, now + 0.1);
                    snare.stop(now + 0.1);
                }
                
                beatCount++;
                
                // N√¶ste beat (120 BPM = 500ms per beat)
                setTimeout(playBeat, 500);
            }
            
            playBeat();
            
            discoAudio = {
                stop: () => {
                    isPlaying = false;
                }
            };
        }
        
        // Keyboard shortcut til admin panel (Ctrl+Shift+A)
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                e.preventDefault();
                openAdminPanel();
            }
        });

        function startGame(level = 'medium') {
            currentLevel = level;
            const settings = levelSettings[level];
            
            // Anvend level indstillinger
            gravity = settings.gravity;
            jumpStrength = settings.jumpStrength;
            basePipeSpeed = settings.pipeSpeed;
            currentPipeSpeed = basePipeSpeed;
            pipeSpeed = basePipeSpeed; // For kompatibilitet
            pipeGap = Math.max(200, gameHeight * settings.pipeGapMultiplier);
            
            // Anvend r√∏r farve
            applyPipeColor();
            
            // Opret skyer
            createClouds();
            
            startScreen.style.display = 'none';
            gameRunning = true;
            birdY = gameHeight / 2;
            birdVelocity = 0;
            score = 0;
            pipes = [];
            frameCount = 0;
            scoreDisplay.textContent = score;
            gameOverScreen.style.display = 'none';
            gameLoop = setInterval(update, 1000 / 60);
        }

        function restartGame() {
            // Fjern alle r√∏r
            document.querySelectorAll('.pipe').forEach(pipe => pipe.remove());
            startGame(currentLevel);
        }
        
        function backToIntro() {
            // Skjul game over sk√¶rm
            gameOverScreen.style.display = 'none';
            
            // Fjern alle r√∏r
            document.querySelectorAll('.pipe').forEach(pipe => pipe.remove());
            
            // Reset spil variabler
            pipes = [];
            score = 0;
            scoreDisplay.textContent = score;
            
            // Vis intro sk√¶rm igen
            showIntroScreen();
        }

        function jump() {
            if (gameRunning) {
                birdVelocity = jumpStrength;
            }
        }

        function createPipe() {
            const minHeight = 50;
            const maxHeight = gameHeight * 0.6;
            const topHeight = Math.random() * (maxHeight - minHeight) + minHeight;

            const pipeTop = document.createElement('div');
            pipeTop.className = 'pipe pipe-top';
            pipeTop.style.height = topHeight + 'px';
            pipeTop.style.left = gameWidth + 'px';

            const pipeBottom = document.createElement('div');
            pipeBottom.className = 'pipe pipe-bottom';
            pipeBottom.style.height = (gameHeight - topHeight - pipeGap) + 'px';
            pipeBottom.style.left = gameWidth + 'px';

            gameContainer.appendChild(pipeTop);
            gameContainer.appendChild(pipeBottom);

            // Tjek om r√∏r skal bev√¶ge sig (efter 5 r√∏r)
            const shouldMove = movingPipesEnabled && score >= 5;

            pipes.push({
                x: gameWidth,
                topHeight: topHeight,
                bottomHeight: gameHeight - topHeight - pipeGap,
                scored: false,
                elements: { top: pipeTop, bottom: pipeBottom },
                moving: shouldMove,
                movementDirection: 1, // 1 = ned, -1 = op
                originalTopHeight: topHeight,
                gap: pipeGap // Gem den originale gap st√∏rrelse
            });
        }

        function update() {
            if (!gameRunning) return;

            frameCount++;

            // Opdater fugl
            birdVelocity += gravity;
            birdY += birdVelocity;
            bird.style.top = birdY + 'px';

            // 3D Roter fuglen baseret p√• hastighed
            let rotation = Math.min(Math.max(birdVelocity * 3, -30), 90);
            let tilt = Math.min(Math.max(birdVelocity * 2, -20), 20);
            bird.style.transform = `perspective(500px) rotateZ(${rotation}deg) rotateY(${-5 + tilt}deg) rotateX(${tilt * 0.5}deg) translateZ(10px)`;

            // Tjek om fuglen rammer jorden eller loftet
            if (!godMode && (birdY > gameHeight - 50 || birdY < 0)) {
                endGame();
                return;
            }

            // Opret nye r√∏r
            const pipeFrequency = levelSettings[currentLevel].pipeFrequency;
            if (frameCount % pipeFrequency === 0) {
                createPipe();
            }

            // Opdater hastighed baseret p√• score
            if (speedIncreaseEnabled) {
                currentPipeSpeed = basePipeSpeed + (score * 0.1); // √òg hastighed med 0.1 per point
            } else {
                currentPipeSpeed = basePipeSpeed;
            }

            // Opdater r√∏r
            for (let i = pipes.length - 1; i >= 0; i--) {
                const pipe = pipes[i];
                pipe.x -= currentPipeSpeed;

                // Bev√¶g r√∏r op og ned hvis aktiveret
                if (pipe.moving) {
                    pipe.topHeight += pipe.movementDirection * pipeMovementSpeed;
                    
                    // Skift retning hvis r√∏r n√•r gr√¶nsen
                    if (pipe.topHeight > pipe.originalTopHeight + pipeMovementRange) {
                        pipe.movementDirection = -1;
                    } else if (pipe.topHeight < pipe.originalTopHeight - pipeMovementRange) {
                        pipe.movementDirection = 1;
                    }
                    
                    // Opdater r√∏r h√∏jde - VIGTIGT: Brug original pipeGap!
                    pipe.elements.top.style.height = pipe.topHeight + 'px';
                    // Bunden skal altid v√¶re: gameHeight - topHeight - GAP
                    // Men vi skal bruge den ORIGINALE gap fra da r√∏ret blev oprettet
                    const bottomY = pipe.topHeight + pipe.gap; // Start af bund r√∏r
                    pipe.bottomHeight = gameHeight - bottomY;
                    pipe.elements.bottom.style.height = pipe.bottomHeight + 'px';
                    pipe.elements.bottom.style.top = bottomY + 'px';
                }

                pipe.elements.top.style.left = pipe.x + 'px';
                pipe.elements.bottom.style.left = pipe.x + 'px';

                // Tjek kollision
                if (!godMode && pipe.x < 120 && pipe.x > 20) {
                    if (birdY < pipe.topHeight || birdY + 30 > pipe.topHeight + pipeGap) {
                        endGame();
                        return;
                    }
                }

                // Opdater score
                if (!pipe.scored && pipe.x < 80) {
                    pipe.scored = true;
                    score++;
                    scoreDisplay.textContent = score;
                    
                    // Vis besked n√•r bev√¶gelige r√∏r starter
                    if (score === 5 && movingPipesEnabled) {
                        showMessage('‚ö° R√òRENE BEV√ÜGER SIG NU! ‚ö°', 2000);
                        
                        // Aktiver bev√¶gelse p√• ALLE eksisterende r√∏r
                        pipes.forEach(p => {
                            if (!p.moving) {
                                p.moving = true;
                                p.movementDirection = 1;
                                p.originalTopHeight = p.topHeight;
                            }
                        });
                    }
                }

                // Fjern r√∏r der er ude af sk√¶rmen
                if (pipe.x < -pipeWidth) {
                    pipe.elements.top.remove();
                    pipe.elements.bottom.remove();
                    pipes.splice(i, 1);
                }
            }
        }

        function endGame() {
            gameRunning = false;
            clearInterval(gameLoop);
            
            // Giv coins baseret p√• score
            const coinsEarned = Math.floor(score / 2);
            coins += coinsEarned;
            localStorage.setItem('flappyCoins', coins);
            
            finalScoreDisplay.textContent = score;
            coinsEarnedDisplay.textContent = coinsEarned;
            coinsDisplay.textContent = coins;
            gameOverScreen.style.display = 'block';
            
            // Tjek og opdater highscore
            const currentHighScore = parseInt(localStorage.getItem('flappyHighScore')) || 0;
            if (score > currentHighScore) {
                localStorage.setItem('flappyHighScore', score);
                
                // Upload til Firebase hvis ny rekord
                if (currentUser) {
                    uploadScoreToFirebase(currentUser, score);
                    console.log('üèÜ Ny personlig rekord! Score uploaded til Firebase.');
                }
            }
            
            // Vis admin knapper igen (men de er skjult som standard)
            // De vises kun p√• intro sk√¶rmen
            
            // Gem brugerdata
            saveUserData();
        }

        // Event listeners
        let mouseHeld = false;
        let jumpInterval = null;
        
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space') {
                e.preventDefault();
                jump();
            }
        });

        gameContainer.addEventListener('click', jump);
        
        // Hold musen nede for at flyve kontinuerligt
        gameContainer.addEventListener('mousedown', (e) => {
            if (e.button === 0) { // Venstre museklik
                mouseHeld = true;
                jump(); // F√∏rste hop
                jumpInterval = setInterval(() => {
                    if (mouseHeld && gameRunning) {
                        jump();
                    }
                }, 100); // Hop hver 100ms n√•r musen holdes nede
            }
        });
        
        document.addEventListener('mouseup', (e) => {
            if (e.button === 0) {
                mouseHeld = false;
                if (jumpInterval) {
                    clearInterval(jumpInterval);
                    jumpInterval = null;
                }
            }
        });
        
        gameContainer.addEventListener('touchstart', (e) => {
            e.preventDefault();
            jump();
        });
        
        // Init - Load indstillinger ved page load
        pipeColor = localStorage.getItem('flappyPipeColor') || '#8B4513';
        applyPipeColor();
        
        // PWA Install Prompt
        let deferredPrompt;
        let installButton = null;
        
        window.addEventListener('beforeinstallprompt', (e) => {
            // Prevent default install prompt
            e.preventDefault();
            deferredPrompt = e;
            
            // Vis install knap
            showInstallButton();
        });
        
        function showInstallButton() {
            if (installButton) return; // Allerede vist
            
            installButton = document.createElement('button');
            installButton.textContent = 'üì± Installer App';
            installButton.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                padding: 15px 25px;
                background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%);
                color: white;
                border: none;
                border-radius: 50px;
                font-size: 18px;
                font-weight: bold;
                cursor: pointer;
                z-index: 9999;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                animation: bounce 2s ease-in-out infinite;
            `;
            
            installButton.onclick = async () => {
                if (!deferredPrompt) return;
                
                // Vis install prompt
                deferredPrompt.prompt();
                
                // Vent p√• brugerens valg
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    console.log('App installeret!');
                } else {
                    console.log('Installation afvist');
                }
                
                // Fjern knap
                installButton.remove();
                installButton = null;
                deferredPrompt = null;
            };
            
            document.body.appendChild(installButton);
        }
        
        // Tjek om app allerede er installeret
        window.addEventListener('appinstalled', () => {
            console.log('Flappy Eagle installeret!');
            if (installButton) {
                installButton.remove();
                installButton = null;
            }
        });
        
        // Registrer Service Worker (basic offline support)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                // Inline service worker
                const swCode = `
                    self.addEventListener('install', (e) => {
                        console.log('Service Worker installeret');
                        self.skipWaiting();
                    });
                    
                    self.addEventListener('activate', (e) => {
                        console.log('Service Worker aktiveret');
                        return self.clients.claim();
                    });
                    
                    self.addEventListener('fetch', (e) => {
                        // Lad alle requests g√• igennem (ingen caching)
                        e.respondWith(fetch(e.request));
                    });
                `;
                
                const blob = new Blob([swCode], { type: 'application/javascript' });
                const swUrl = URL.createObjectURL(blob);
                
                navigator.serviceWorker.register(swUrl)
                    .then(reg => console.log('Service Worker registreret'))
                    .catch(err => console.log('Service Worker fejl:', err));
            });
        }
        
        // Prevent zoom on double tap (iOS)
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</body>
</html>